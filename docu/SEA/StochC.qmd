---
  title: "Stochastic Calculus"
  abstract: Would be including the notes and topics from Shreve's and Grezelak's book as well topics that would fall into this category.Including code implementation in python based of the book.<br/><br/>DISCLAIMER THERE IS AT TIMES LOT OF HAND WAVING ,THIS IS NOT AS MATHEMATICALLY RIGOROUS AS YOU WOULD EXPECT LIKE IN A PURE MATH TEXTBOOK.
  toc: true
  execute: 
    eval: true
    warning: false
  format:
    html:
      html-math-method: katex
      #code-block-bg: "#E5E7E9"  
      style: "background : #020508"
---

## Resources

These are list of books , videos and courses that I am currently referencing for content on this page , for more detailed list please check out the resource section above.

-   Mathematical modelling and computation in finance by Cornerlis Ooseterlee and Lech Grzelak (Main Text)

-   Stochastic CalcuIus for Finance II Continuous-Time Models by Steven Shreve (Main Reference text)

-   Stochastic Differential Equations By Bernt Oksendal

## Preliminaries

::: {#def-sigma}
## $\sigma$ algebra

: Let $\Omega$ be a nonempty set , and let $\mathcal{F}$ be a set of collections of subsets of $\Omega$. We say that $\mathcal{F}$ is a $\sigma$ algebra provided that

i)  The empty set $\emptyset$ belongs to $\mathcal{F}$
ii) $A$ and $A^{c}$ belong to $\mathcal{F}$ whenever A $\in$ $\mathcal{F}$
iii) whenever $$A_1 ,A_2 ,A_3 ..... \in \mathcal{F}$$ then $\bigcup_{i=1}^\infty A_{i} \in \mathcal{F}$
:::

<br/> <br/>

::: {#def-ProbMeasure}
## Probability measure

: Let $\Omega$ be a nonempty set , and let $\mathbb{F}$ be $\sigma$ algebra of subsets of $\Omega$. A probability measure $\mathbb{P}$ is a function that, to every set $A \in \mathcal{F}$ , assigns a number in $[0,1]$ called the probability of $A$ written as $\mathbb{P}(A)$ .We require

i)  $\mathbb{P}(\Omega) = 1$ and

ii) (Countable Additivity) Whenever $A_1,A_2,A_3....$ is a sequence of disjoint sets in $\mathcal{F}$ , then $$\mathbb{P}(\bigcup_{n=1}^\infty A_n) = \sum_{n=1}^{\infty} \mathbb{P}(A_n) $$

<br/> The Triple $(\Omega, \mathcal{F},\mathbb{}P)$ is called probability measure
:::

<br/> From the above it follows that for finitely many disjoint sets $A_1, A_2,A_3....A_n$ $$\mathbb{P}(\bigcup_{n=1}^N) = \sum_{n=1}^N \mathbb{P}(A_n)$$

and $\mathbb{P}(A^c) = 1 - \mathbb{P}(A)$

::: {#exm-1.1 style="background: #020508"}
## Uniform(Lebesgue) measure on $[0,1]$

<br/> $\Omega = [0,1]$<br/> $\mathbb{P}[a,b] = b-a ,0 \leq a \leq b \leq1$ <br/> single points have zero probability and <br/> $(a,b)$ can be written as $$ \bigcup_{n=1}^\infty[a+\frac{1}{n} , b -\frac{1}{n}]$$
:::

<br/> <br/> The $\sigma$-algebra beginning with closed intervals and adding everything else necessary in order to have a $\sigma$- algebra is called a Borel $\sigma$-algebra and denoted by $\mathcal{B}[0,1]$. Borel $\sigma$-algebras are $\sigma$-algebra generated by open sets and equivalently closed sets over any topological space.

::: {#def-almostsurely}
let $(\Omega,\mathcal{F},\mathbb{P})$ be a probability space. If a set $A \in \mathcal{F}$ satisfies $\mathbb{P}(A) = 1$, we say the event $A$ occurs almost surely
:::

::: {#exm-1.2 style="background: #020508"}
Let $\mathbb{P}$ be the uniform measure as defined in example 1. Define $X(\omega) = \omega$ and $Y(\omega) = 1 - \omega$ for all $\omega \in [0,1]$ , then the distribution measure of X is uniform $$\mu_{X}[a,b] = \mathbb{P}\{\omega;a\leq X(w)\leq b\} = \mathbb{P}[a,b] = b-a, 0\leq a \leq b \leq 1$$ by definition of $\mathbb{P}$. <br/> Its easy to see to see that $X$ and $Y$ have the same distribution. But under the probability measure$\mathbb{\widetilde{P}}$ on $[0,1]$ defined by $$\mathbb{\widetilde{P}[a,b]} = \int_a^b 2\omega \, d\omega = b^2-a^2  , 0 \leq a\leq b \leq1 $$ $X$ and $Y$ have different distributions.
:::

::: {#def-CDF}
## cumulative distribution function and density function

$$ F(x) = \mathbb{P}\{X \leq x\} , x \in \mathbb{R}$$ $$\mu_X[a,b] = \mathbb{P}\{a \leq X \leq b \} = \int_a^b f(x) \, dx , -\infty < a \leq b < \infty$$ $f(x)$ is called the density funtion and $F(x)$ is called the cummulative distribution function.
:::

::: {#exm-1.3 style="background: #020508"}
## Standard normal random variable

Let $$\phi(x)  = \frac {a}{\sqrt{2\pi}}e^{\frac{-x^2}{2}}$$ be the standard normal density and definiing the cummulative normal distribution function as $$N(x) = \int_{-\infty}^x \phi(\xi)\,d\xi$$ The function $N(x)$ is strictly increasing function which is surjective onto $(0,1)$ from $\mathbb{R}$, so it has a strictly increasing inverse function $N^{-1}(y),y \in (0,1)$. Let $Y$ be a uniformly distributed random variable defined on some probability space $(\Omega,\mathcal{F},\mathbb{P})$ and set $X = N^{-1}(Y)$ then

```{=tex}
\begin{align*}

\mu_X[a,b] &= \mathbb{P}\{\omega \in \Omega ; a \leq X(\omega) \leq b\} \\

          &= \mathbb{P}\{\omega \in \Omega ; a \leq N^{-1}(Y(\omega)) \leq b\}\\
            
          &= \mathbb{P}\{\omega \in \Omega ; N(a) \leq Y(\omega) \leq N(b) \} \\
        
          &= N(b) - N(a) \\
          &= \int_a^b \phi(x) \, dx

\end{align*}
```
Any random variable that has this distribution regardless of the probability space is called standard normal distribution.<br/> Thing to note the use of uniformly distributed random variable for generating a standard random variable is called probability integral transform and this is commonly used in Monte Carlo simulation
:::

<br/><br/>

## Stochastic Processes

::: {#def}
### Weiner process

A fundamental stochastic process, which is also commonly used in the construction of stochastic differential equations (SDEs) to describe asset price movements, is the Wiener process, also called Brownian motion. Mathematically, a Wiener process, $W(t)$, is characterized by the following properties:

<p style="font-size:15px">

<br>$a)\quad W(t\_{0}) = 0 (technically:\mathbb{P}[W(t_0)=0] =1)$</br> <br>$b)\quad W(t) is\quad almost \quad surely \quad continous$</br> <br>$c)\quad W(t) \quad has \quad independent \quad incerements \quad with \quad distribution\quad W(t)- W(s) \sim \mathcal{N}(0,t-s)$</br>

</p>
:::

<br/><br/>

## Black-Scholes model

<!-- --- -->
<!-- title: "Complete Black-Scholes Proofs: From First Principles" -->
<!-- author: "" -->
<!-- date: today -->
<!-- format: -->
<!--   html: -->
<!--     toc: true -->
<!--     toc-depth: 3 -->
<!--     number-sections: true -->
<!--     html-math-method: mathjax -->
<!--   pdf: -->
<!--     toc: true -->
<!--     number-sections: true -->
<!--     geometry: -->
<!--       - top=1in -->
<!--       - left=1in -->
<!--       - right=1in -->
<!--       - bottom=1in -->
<!-- --- -->

# Part I: Mathematical Foundations and Definitions

This section establishes all the mathematical machinery needed for the Black-Scholes proofs. We assume knowledge of measure theory and basic stochastic calculus but will define all financial and probabilistic concepts explicitly.

## Financial Market Framework

::: {.callout-note icon=false}
## Definition 1.1 (Financial Market)
A financial market consists of:

1. A probability space $(\Omega, \mathcal{F}, \mathbb{P})$ where $\Omega$ represents all possible market scenarios
2. A filtration $\{\mathcal{F}_t\}_{t \geq 0}$ representing information available at time $t$
3. A finite collection of traded assets with price processes $\{S^i_t\}_{i=0,1,\ldots,n}$
:::

::: {.callout-note icon=false}
## Definition 1.2 (Brownian Motion)
A stochastic process $\{W_t\}_{t \geq 0}$ on $(\Omega, \mathcal{F}, \mathbb{P})$ is a standard Brownian motion if:

1. $W_0 = 0$ almost surely
2. $W$ has independent increments: for $0 \leq s < t$, $W_t - W_s$ is independent of $\mathcal{F}_s$
3. $W_t - W_s \sim N(0, t-s)$ for all $0 \leq s < t$
4. $W$ has continuous sample paths almost surely
:::

::: {.callout-note icon=false}
## Definition 1.3 (Natural Filtration of Brownian Motion)
The natural filtration of Brownian motion is 
$$\mathcal{F}_t^W = \sigma(W_s : 0 \leq s \leq t)$$
the $\sigma$-algebra generated by the Brownian motion up to time $t$.
:::

::: {.callout-note icon=false}
## Definition 1.4 (Adapted Process)
A stochastic process $\{X_t\}_{t \geq 0}$ is adapted to the filtration $\{\mathcal{F}_t\}$ if $X_t$ is $\mathcal{F}_t$-measurable for all $t \geq 0$.
:::

::: {.callout-note icon=false}
## Definition 1.5 (Geometric Brownian Motion)
A process $\{S_t\}_{t \geq 0}$ follows geometric Brownian motion with parameters $\mu \in \mathbb{R}$ and $\sigma > 0$ if it satisfies the stochastic differential equation:
$$dS_t = \mu S_t \, dt + \sigma S_t \, dW_t$$
with initial condition $S_0 > 0$.
:::

::: {.callout-tip}
## Remark 1.1
The explicit solution to geometric Brownian motion is:
$$S_t = S_0 \exp\left(\left(\mu - \frac{\sigma^2}{2}\right)t + \sigma W_t\right)$$
This can be verified using Itô's lemma on $f(t,x) = \ln x$.
:::

## Portfolio and Trading Strategy Concepts

::: {.callout-note icon=false}
## Definition 1.6 (Trading Strategy)
A trading strategy is a pair of adapted processes $(\phi^0_t, \phi^1_t)$ where:

- $\phi^0_t$ represents the number of units of the bond held at time $t$
- $\phi^1_t$ represents the number of shares of stock held at time $t$

Both processes must be adapted to the filtration $\{\mathcal{F}_t\}$.
:::

::: {.callout-note icon=false}
## Definition 1.7 (Portfolio Value)
The value of a portfolio with trading strategy $(\phi^0_t, \phi^1_t)$ at time $t$ is:
$$V_t = \phi^0_t B_t + \phi^1_t S_t$$
where $B_t$ is the bond price and $S_t$ is the stock price.
:::

::: {.callout-note icon=false}
## Definition 1.8 (Self-Financing Strategy)
A trading strategy $(\phi^0_t, \phi^1_t)$ is self-financing if:
$$dV_t = \phi^0_t dB_t + \phi^1_t dS_t$$
This means no money is added or withdrawn from the portfolio; changes in value come only from price movements of held assets.
:::

::: {.callout-note icon=false}
## Definition 1.9 (Arbitrage Opportunity)
An arbitrage opportunity is a self-financing trading strategy with:

1. Initial value $V_0 = 0$
2. $\mathbb{P}(V_T \geq 0) = 1$ for some time $T > 0$
3. $\mathbb{P}(V_T > 0) > 0$
:::

::: {.callout-note icon=false}
## Definition 1.10 (Arbitrage-Free Market)
A market is arbitrage-free if no arbitrage opportunities exist.
:::

## Martingale Theory for Finance

::: {.callout-note icon=false}
## Definition 1.11 (Martingale)
An adapted process $\{M_t\}_{t \geq 0}$ is a martingale with respect to filtration $\{\mathcal{F}_t\}$ and probability measure $\mathbb{P}$ if:

1. $\mathbb{E}[|M_t|] < \infty$ for all $t \geq 0$
2. $\mathbb{E}[M_t | \mathcal{F}_s] = M_s$ for all $0 \leq s \leq t$
:::

::: {.callout-note icon=false}
## Definition 1.12 (Equivalent Probability Measures)
Two probability measures $\mathbb{P}$ and $\mathbb{Q}$ on $(\Omega, \mathcal{F})$ are equivalent (written $\mathbb{P} \sim \mathbb{Q}$) if they have the same null sets:
$$\mathbb{P}(A) = 0 \iff \mathbb{Q}(A) = 0 \text{ for all } A \in \mathcal{F}$$
:::

::: {.callout-note icon=false}
## Definition 1.13 (Radon-Nikodym Derivative)
If $\mathbb{Q} \ll \mathbb{P}$ (Q is absolutely continuous with respect to P), then there exists a non-negative $\mathcal{F}$-measurable random variable $Z$ such that:
$$\mathbb{Q}(A) = \int_A Z \, d\mathbb{P} \text{ for all } A \in \mathcal{F}$$
We write $Z = \frac{d\mathbb{Q}}{d\mathbb{P}}$ and call $Z$ the Radon-Nikodym derivative.
:::

::: {.callout-important icon=false}
## Theorem 1.1 (Girsanov's Theorem - Statement)
Let $\theta$ be an adapted process with $\int_0^T \theta_s^2 \, ds < \infty$ almost surely. Define:
$$Z_t = \exp\left(-\int_0^t \theta_s \, dW_s - \frac{1}{2}\int_0^t \theta_s^2 \, ds\right)$$

If $\mathbb{E}[Z_T] = 1$, then:

1. The process $Z_t$ is a martingale
2. The measure $\mathbb{Q}$ defined by $\frac{d\mathbb{Q}}{d\mathbb{P}} = Z_T$ is a probability measure equivalent to $\mathbb{P}$
3. Under $\mathbb{Q}$, the process $\tilde{W}_t = W_t + \int_0^t \theta_s \, ds$ is a Brownian motion
:::

::: {.callout-note icon=false}
## Definition 1.14 (Risk-Neutral Measure)
In a financial market with bond $B_t = e^{rt}$ and stock following 
$$dS_t = \mu S_t \, dt + \sigma S_t \, dW_t$$
a probability measure $\mathbb{Q}$ equivalent to $\mathbb{P}$ is called risk-neutral if the discounted stock price $e^{-rt}S_t$ is a $\mathbb{Q}$-martingale.
:::

## Options and Derivatives

::: {.callout-note icon=false}
## Definition 1.15 (European Option)
A European option is a financial contract that gives the holder the right (but not obligation) to:

- **Call option**: Buy an asset at strike price $K$ at maturity time $T$
- **Put option**: Sell an asset at strike price $K$ at maturity time $T$
:::

::: {.callout-note icon=false}
## Definition 1.16 (Option Payoff)
The payoff of a European option at maturity $T$ is:

- **Call**: $h(S_T) = (S_T - K)^+ = \max(S_T - K, 0)$
- **Put**: $h(S_T) = (K - S_T)^+ = \max(K - S_T, 0)$

where $S_T$ is the stock price at maturity.
:::

::: {.callout-note icon=false}
## Definition 1.17 (Option Price)
The price of an option at time $t$ is denoted $V(t, S_t)$ and depends on the current time $t$ and current stock price $S_t$.
:::

::: {.callout-note icon=false}
## Definition 1.18 (Replicating Portfolio)
A replicating portfolio for an option is a self-financing trading strategy $(\phi^0_t, \phi^1_t)$ such that the portfolio value at maturity equals the option payoff:
$$V_T = \phi^0_T B_T + \phi^1_T S_T = h(S_T)$$
:::

## Fundamental Theorems of Asset Pricing

::: {.callout-important icon=false}
## Theorem 1.2 (First Fundamental Theorem of Asset Pricing)
A market is arbitrage-free if and only if there exists a probability measure $\mathbb{Q}$ equivalent to $\mathbb{P}$ such that all discounted asset prices are $\mathbb{Q}$-martingales.
:::

::: {.callout-important icon=false}
## Theorem 1.3 (Second Fundamental Theorem of Asset Pricing)
An arbitrage-free market is complete if and only if the risk-neutral measure is unique.
:::

::: {.callout-note icon=false}
## Definition 1.19 (Complete Market)
A market is complete if every contingent claim (option payoff) can be replicated by a self-financing trading strategy.
:::

::: {.callout-important icon=false}
## Theorem 1.4 (Risk-Neutral Valuation Principle)
In an arbitrage-free complete market, the price of any attainable contingent claim $h(S_T)$ at time $t$ is:
$$V(t, S_t) = e^{-r(T-t)} \mathbb{E}_\mathbb{Q}[h(S_T) | \mathcal{F}_t]$$
where $\mathbb{Q}$ is the unique risk-neutral measure.
:::

# Part II: The Black-Scholes Model Setup

## Model Specification

We consider a financial market on a probability space $(\Omega, \mathcal{F}, \mathbb{P})$ with filtration $\{\mathcal{F}_t\}_{t \geq 0}$ and two traded assets:

::: {.callout-note icon=false}
## Definition 2.1 (Black-Scholes Market Model)
The Black-Scholes market consists of:

1. **Risk-free bond**: $dB_t = rB_t \, dt$ with $B_0 = 1$, giving $B_t = e^{rt}$
2. **Risky stock**: $dS_t = \mu S_t \, dt + \sigma S_t \, dW_t$ with $S_0 > 0$

where:

- $r > 0$ is the constant risk-free interest rate
- $\mu \in \mathbb{R}$ is the stock's expected return (drift)
- $\sigma > 0$ is the stock's volatility
- $\{W_t\}_{t \geq 0}$ is a standard Brownian motion adapted to $\{\mathcal{F}_t\}$
:::

::: {.callout-note icon=false}
## Definition 2.2 (European Call Option in Black-Scholes Model)
We consider a European call option with:

- Strike price $K > 0$
- Maturity time $T > 0$  
- Payoff at maturity: $h(S_T) = (S_T - K)^+$

Our goal is to find the option price $V(t, S_t)$ for $0 \leq t \leq T$.
:::

## Key Properties of the Model

::: {.callout-important icon=false}
## Lemma 2.1 (Stock Price Solution)
The solution to the stock price SDE $dS_t = \mu S_t \, dt + \sigma S_t \, dW_t$ is:
$$S_t = S_0 \exp\left(\left(\mu - \frac{\sigma^2}{2}\right)t + \sigma W_t\right)$$
:::

::: {.callout-note collapse="true"}
## Proof of Lemma 2.1
Let $Y_t = \ln S_t$. By Itô's lemma with $f(x) = \ln x$:

\begin{align}
dY_t &= f'(S_t) dS_t + \frac{1}{2}f''(S_t)(dS_t)^2 \\
&= \frac{1}{S_t} dS_t + \frac{1}{2}\left(-\frac{1}{S_t^2}\right)(dS_t)^2 \\
&= \frac{1}{S_t}(\mu S_t \, dt + \sigma S_t \, dW_t) - \frac{1}{2S_t^2}(\sigma S_t)^2 dt \\
&= \mu \, dt + \sigma \, dW_t - \frac{\sigma^2}{2} dt \\
&= \left(\mu - \frac{\sigma^2}{2}\right) dt + \sigma \, dW_t
\end{align}

Integrating from $0$ to $t$:
$$Y_t = Y_0 + \left(\mu - \frac{\sigma^2}{2}\right)t + \sigma W_t$$

Since $Y_t = \ln S_t$ and $Y_0 = \ln S_0$:
$$\ln S_t = \ln S_0 + \left(\mu - \frac{\sigma^2}{2}\right)t + \sigma W_t$$

Therefore:
$$S_t = S_0 \exp\left(\left(\mu - \frac{\sigma^2}{2}\right)t + \sigma W_t\right)$$
:::

::: {.callout-important icon=false}
## Corollary 2.1 (Log-Normal Distribution of Stock Price)
Under $\mathbb{P}$, we have:
$$\ln(S_t/S_0) \sim N\left(\left(\mu - \frac{\sigma^2}{2}\right)t, \sigma^2 t\right)$$
:::

# Part III: Proof via Martingale Approach

## Step 1: Construction of Risk-Neutral Measure

::: {.callout-important icon=false}
## Theorem 3.1 (Existence of Risk-Neutral Measure in Black-Scholes)
There exists a unique probability measure $\mathbb{Q}$ equivalent to $\mathbb{P}$ such that the discounted stock price $e^{-rt}S_t$ is a $\mathbb{Q}$-martingale.
:::

::: {.callout-note collapse="true"}
## Proof of Theorem 3.1

**Step 1**: Define the market price of risk:
$$\theta = \frac{\mu - r}{\sigma}$$

This is the constant that will appear in Girsanov's theorem.

**Step 2**: Define the Radon-Nikodym density process:
\begin{align}
Z_t &= \exp\left(-\theta W_t - \frac{1}{2}\theta^2 t\right) \\
&= \exp\left(-\frac{\mu - r}{\sigma} W_t - \frac{1}{2}\left(\frac{\mu - r}{\sigma}\right)^2 t\right)
\end{align}

**Step 3**: Verify that $Z_t$ is a martingale and $\mathbb{E}[Z_T] = 1$.

Since $\theta$ is constant, we can compute:
$$\mathbb{E}[Z_t] = \mathbb{E}\left[\exp\left(-\theta W_t - \frac{1}{2}\theta^2 t\right)\right]$$

Since $W_t \sim N(0,t)$ under $\mathbb{P}$:
\begin{align}
\mathbb{E}[Z_t] &= \int_{-\infty}^{\infty} \exp\left(-\theta w - \frac{1}{2}\theta^2 t\right) \frac{1}{\sqrt{2\pi t}} \exp\left(-\frac{w^2}{2t}\right) dw \\
&= \exp\left(-\frac{1}{2}\theta^2 t\right) \int_{-\infty}^{\infty} \frac{1}{\sqrt{2\pi t}} \exp\left(-\frac{w^2 + 2\theta tw}{2t}\right) dw \\
&= \exp\left(-\frac{1}{2}\theta^2 t\right) \int_{-\infty}^{\infty} \frac{1}{\sqrt{2\pi t}} \exp\left(-\frac{(w + \theta t)^2 - \theta^2 t^2}{2t}\right) dw \\
&= \exp\left(-\frac{1}{2}\theta^2 t\right) \exp\left(\frac{1}{2}\theta^2 t\right) \int_{-\infty}^{\infty} \frac{1}{\sqrt{2\pi t}} \exp\left(-\frac{(w + \theta t)^2}{2t}\right) dw \\
&= 1
\end{align}

The last integral equals 1 since it's the integral of a normal density.

**Step 4**: Define $\mathbb{Q}$ by $\frac{d\mathbb{Q}}{d\mathbb{P}} = Z_T$.

**Step 5**: Apply Girsanov's theorem. Under $\mathbb{Q}$, the process:
$$\tilde{W}_t = W_t + \int_0^t \theta \, ds = W_t + \theta t$$
is a $\mathbb{Q}$-Brownian motion.

**Step 6**: Transform the stock price dynamics. Under $\mathbb{Q}$:
\begin{align}
dS_t &= \mu S_t \, dt + \sigma S_t \, dW_t \\
&= \mu S_t \, dt + \sigma S_t (d\tilde{W}_t - \theta \, dt) \\
&= \mu S_t \, dt + \sigma S_t \, d\tilde{W}_t - \sigma S_t \theta \, dt \\
&= (\mu - \sigma\theta) S_t \, dt + \sigma S_t \, d\tilde{W}_t \\
&= \left(\mu - \sigma \cdot \frac{\mu - r}{\sigma}\right) S_t \, dt + \sigma S_t \, d\tilde{W}_t \\
&= r S_t \, dt + \sigma S_t \, d\tilde{W}_t
\end{align}

**Step 7**: Verify the martingale property. The discounted stock price is:
$$e^{-rt}S_t$$

Its differential is:
\begin{align}
d(e^{-rt}S_t) &= -re^{-rt}S_t \, dt + e^{-rt} dS_t \\
&= -re^{-rt}S_t \, dt + e^{-rt}(rS_t \, dt + \sigma S_t \, d\tilde{W}_t) \\
&= e^{-rt}\sigma S_t \, d\tilde{W}_t
\end{align}

Since this has no $dt$ term, $e^{-rt}S_t$ is a $\mathbb{Q}$-martingale.
:::

## Step 2: Stock Price Under Risk-Neutral Measure

::: {.callout-important icon=false}
## Lemma 3.1 (Stock Price Solution Under $\mathbb{Q}$)
Under the risk-neutral measure $\mathbb{Q}$, the stock price has the explicit form:
$$S_t = S_0 \exp\left(\left(r - \frac{\sigma^2}{2}\right)t + \sigma \tilde{W}_t\right)$$
where $\tilde{W}_t$ is a $\mathbb{Q}$-Brownian motion.
:::

::: {.callout-note collapse="true"}
## Proof of Lemma 3.1
Under $\mathbb{Q}$, the stock follows:
$$dS_t = rS_t \, dt + \sigma S_t \, d\tilde{W}_t$$

Using the same technique as in the original measure, let $Y_t = \ln S_t$:
\begin{align}
dY_t &= \frac{1}{S_t} dS_t - \frac{1}{2S_t^2}(dS_t)^2 \\
&= \frac{1}{S_t}(rS_t \, dt + \sigma S_t \, d\tilde{W}_t) - \frac{1}{2S_t^2}(\sigma S_t)^2 dt \\
&= r \, dt + \sigma \, d\tilde{W}_t - \frac{\sigma^2}{2} dt \\
&= \left(r - \frac{\sigma^2}{2}\right) dt + \sigma \, d\tilde{W}_t
\end{align}

Integrating:
$$Y_t = Y_0 + \left(r - \frac{\sigma^2}{2}\right)t + \sigma \tilde{W}_t$$

Therefore:
$$S_t = S_0 \exp\left(\left(r - \frac{\sigma^2}{2}\right)t + \sigma \tilde{W}_t\right)$$
:::

## Step 3: Risk-Neutral Valuation

::: {.callout-important icon=false}
## Theorem 3.2 (Risk-Neutral Option Pricing)
The price of the European call option at time $t$ is:
$$V(t, S_t) = e^{-r(T-t)} \mathbb{E}_\mathbb{Q}[(S_T - K)^+ | \mathcal{F}_t]$$
:::

::: {.callout-note collapse="true"}
## Proof of Theorem 3.2
This follows directly from the risk-neutral valuation principle. In an arbitrage-free complete market, the option price equals the discounted expected payoff under the risk-neutral measure.
:::

## Step 4: Computing the Expectation

::: {.callout-important icon=false}
## Theorem 3.3 (Black-Scholes Formula via Martingale Method)
The European call option price is:
$$V(t, S_t) = S_t \Phi(d_1) - K e^{-r(T-t)} \Phi(d_2)$$
where:
\begin{align}
d_1 &= \frac{\ln(S_t/K) + (r + \sigma^2/2)(T-t)}{\sigma\sqrt{T-t}} \\
d_2 &= d_1 - \sigma\sqrt{T-t} = \frac{\ln(S_t/K) + (r - \sigma^2/2)(T-t)}{\sigma\sqrt{T-t}}
\end{align}
and $\Phi$ is the cumulative distribution function of the standard normal distribution.
:::

::: {.callout-note collapse="true"}
## Proof of Theorem 3.3

**Step 1**: Express the stock price at maturity.
Under $\mathbb{Q}$, using the strong Markov property:
$$S_T = S_t \exp\left(\left(r - \frac{\sigma^2}{2}\right)(T-t) + \sigma (\tilde{W}_T - \tilde{W}_t)\right)$$

Since $\tilde{W}_T - \tilde{W}_t \sim N(0, T-t)$ under $\mathbb{Q}$, let $Z \sim N(0,1)$. Then:
$$S_T = S_t \exp\left(\left(r - \frac{\sigma^2}{2}\right)(T-t) + \sigma\sqrt{T-t} \cdot Z\right)$$

**Step 2**: Set up the expectation.
\begin{align}
V(t, S_t) &= e^{-r(T-t)} \mathbb{E}_\mathbb{Q}[(S_T - K)^+ | \mathcal{F}_t] \\
&= e^{-r(T-t)} \mathbb{E}_\mathbb{Q}\left[\left(S_t e^{(r-\sigma^2/2)(T-t) + \sigma\sqrt{T-t} Z} - K\right)^+\right]
\end{align}

**Step 3**: Find the exercise region.
The option is exercised when $S_T > K$, i.e., when:
$$S_t e^{(r-\sigma^2/2)(T-t) + \sigma\sqrt{T-t} Z} > K$$

Taking logarithms:
\begin{align}
&(r-\sigma^2/2)(T-t) + \sigma\sqrt{T-t} Z > \ln(K/S_t) \\
&Z > \frac{\ln(K/S_t) - (r-\sigma^2/2)(T-t)}{\sigma\sqrt{T-t}} = -d_2
\end{align}

**Step 4**: Evaluate the integral.
\begin{align}
V(t, S_t) &= e^{-r(T-t)} \int_{-d_2}^{\infty} \left(S_t e^{(r-\sigma^2/2)(T-t) + \sigma\sqrt{T-t} z} - K\right) \\
&\quad \times \frac{1}{\sqrt{2\pi}} e^{-z^2/2} dz \\
&= e^{-r(T-t)} S_t e^{(r-\sigma^2/2)(T-t)} \int_{-d_2}^{\infty} e^{\sigma\sqrt{T-t} z} \frac{1}{\sqrt{2\pi}} e^{-z^2/2} dz \\
&\quad - e^{-r(T-t)} K \int_{-d_2}^{\infty} \frac{1}{\sqrt{2\pi}} e^{-z^2/2} dz
\end{align}

**Step 5**: Evaluate the first integral.
For the first integral, complete the square in the exponent:
$$\sigma\sqrt{T-t} z - \frac{z^2}{2} = -\frac{1}{2}(z - \sigma\sqrt{T-t})^2 + \frac{\sigma^2(T-t)}{2}$$

Therefore:
\begin{align}
&\int_{-d_2}^{\infty} e^{\sigma\sqrt{T-t} z} \frac{1}{\sqrt{2\pi}} e^{-z^2/2} dz \\
&= e^{\sigma^2(T-t)/2} \int_{-d_2}^{\infty} \frac{1}{\sqrt{2\pi}} e^{-(z-\sigma\sqrt{T-t})^2/2} dz \\
&= e^{\sigma^2(T-t)/2} \int_{-d_2-\sigma\sqrt{T-t}}^{\infty} \frac{1}{\sqrt{2\pi}} e^{-u^2/2} du \\
&= e^{\sigma^2(T-t)/2} \Phi(d_2 + \sigma\sqrt{T-t}) \\
&= e^{\sigma^2(T-t)/2} \Phi(d_1)
\end{align}

where we used the substitution $u = z - \sigma\sqrt{T-t}$ and the fact that:
$$d_2 + \sigma\sqrt{T-t} = d_1$$

**Step 6**: Evaluate the second integral.
$$\int_{-d_2}^{\infty} \frac{1}{\sqrt{2\pi}} e^{-z^2/2} dz = \Phi(d_2)$$

**Step 7**: Combine the results.
\begin{align}
V(t, S_t) &= e^{-r(T-t)} S_t e^{(r-\sigma^2/2)(T-t)} e^{\sigma^2(T-t)/2} \Phi(d_1) - e^{-r(T-t)} K \Phi(d_2) \\
&= S_t e^{-r(T-t)} e^{(r-\sigma^2/2)(T-t)} e^{\sigma^2(T-t)/2} \Phi(d_1) - K e^{-r(T-t)} \Phi(d_2) \\
&= S_t e^{-r(T-t) + r(T-t) - \sigma^2(T-t)/2 + \sigma^2(T-t)/2} \Phi(d_1) - K e^{-r(T-t)} \Phi(d_2) \\
&= S_t \Phi(d_1) - K e^{-r(T-t)} \Phi(d_2)
\end{align}
:::

# Part IV: Proof via PDE Approach

## Step 1: Delta Hedging Strategy

::: {.callout-note icon=false}
## Definition 4.1 (Delta Hedging Portfolio)
Consider a portfolio $\Pi_t$ consisting of:

- Long position: 1 unit of the option with value $V(t, S_t)$
- Short position: $\Delta_t$ shares of the stock
- Cash position: The remaining value invested in bonds

The portfolio value is:
$\Pi_t = V(t, S_t) - \Delta_t S_t$
:::

::: {.callout-note icon=false}
## Definition 4.2 (Delta)
The delta $\Delta_t$ represents the hedge ratio - the number of shares of stock to short for each option held. We will determine $\Delta_t$ to make the portfolio risk-free.
:::

## Step 2: Application of Itô's Lemma to Option Value

::: {.callout-important icon=false}
## Lemma 4.1 (Stochastic Differential of Option Value)
Assume the option price has the form $V(t, S_t)$ where $V \in C^{1,2}([0,T] \times (0,\infty))$. Then by Itô's lemma:
\begin{align}
dV &= \frac{\partial V}{\partial t} dt + \frac{\partial V}{\partial S} dS_t + \frac{1}{2}\frac{\partial^2 V}{\partial S^2} (dS_t)^2 \\
&= \left[\frac{\partial V}{\partial t} + \mu S_t \frac{\partial V}{\partial S} + \frac{1}{2}\sigma^2 S_t^2 \frac{\partial^2 V}{\partial S^2}\right] dt + \sigma S_t \frac{\partial V}{\partial S} dW_t
\end{align}
:::

::: {.callout-note collapse="true"}
## Proof of Lemma 4.1
Since $dS_t = \mu S_t \, dt + \sigma S_t \, dW_t$, we have:
$(dS_t)^2 = (\mu S_t \, dt + \sigma S_t \, dW_t)^2 = \sigma^2 S_t^2 (dW_t)^2 = \sigma^2 S_t^2 dt$

where we used the fact that $(dW_t)^2 = dt$, $dt \cdot dW_t = 0$, and $(dt)^2 = 0$.

Applying Itô's lemma:
\begin{align}
dV &= \frac{\partial V}{\partial t} dt + \frac{\partial V}{\partial S} dS_t + \frac{1}{2}\frac{\partial^2 V}{\partial S^2} (dS_t)^2 \\
&= \frac{\partial V}{\partial t} dt + \frac{\partial V}{\partial S} (\mu S_t \, dt + \sigma S_t \, dW_t) + \frac{1}{2}\frac{\partial^2 V}{\partial S^2} \sigma^2 S_t^2 dt \\
&= \left[\frac{\partial V}{\partial t} + \mu S_t \frac{\partial V}{\partial S} + \frac{1}{2}\sigma^2 S_t^2 \frac{\partial^2 V}{\partial S^2}\right] dt + \sigma S_t \frac{\partial V}{\partial S} dW_t
\end{align}
:::

## Step 3: Portfolio Dynamics

::: {.callout-important icon=false}
## Lemma 4.2 (Portfolio Value Dynamics)
The change in portfolio value is:
\begin{align}
d\Pi_t &= dV - \Delta_t dS_t \\
&= \left[\frac{\partial V}{\partial t} + \mu S_t \left(\frac{\partial V}{\partial S} - \Delta_t\right) + \frac{1}{2}\sigma^2 S_t^2 \frac{\partial^2 V}{\partial S^2}\right] dt \\
&\quad + \sigma S_t \left(\frac{\partial V}{\partial S} - \Delta_t\right) dW_t
\end{align}
:::

::: {.callout-note collapse="true"}
## Proof of Lemma 4.2
We have:
\begin{align}
d\Pi_t &= dV - \Delta_t dS_t \\
&= \left[\frac{\partial V}{\partial t} + \mu S_t \frac{\partial V}{\partial S} + \frac{1}{2}\sigma^2 S_t^2 \frac{\partial^2 V}{\partial S^2}\right] dt + \sigma S_t \frac{\partial V}{\partial S} dW_t \\
&\quad - \Delta_t (\mu S_t dt + \sigma S_t dW_t) \\
&= \left[\frac{\partial V}{\partial t} + \mu S_t \frac{\partial V}{\partial S} + \frac{1}{2}\sigma^2 S_t^2 \frac{\partial^2 V}{\partial S^2} - \Delta_t \mu S_t\right] dt \\
&\quad + \sigma S_t \left(\frac{\partial V}{\partial S} - \Delta_t\right) dW_t \\
&= \left[\frac{\partial V}{\partial t} + \mu S_t \left(\frac{\partial V}{\partial S} - \Delta_t\right) + \frac{1}{2}\sigma^2 S_t^2 \frac{\partial^2 V}{\partial S^2}\right] dt \\
&\quad + \sigma S_t \left(\frac{\partial V}{\partial S} - \Delta_t\right) dW_t
\end{align}
:::

## Step 4: Eliminating Risk

::: {.callout-note icon=false}
## Definition 4.3 (Delta-Neutral Portfolio)
To eliminate the stochastic component, we choose:
$\Delta_t = \frac{\partial V}{\partial S}$

This choice makes the portfolio instantaneously risk-free.
:::

::: {.callout-important icon=false}
## Lemma 4.3 (Risk-Free Portfolio Dynamics)
With $\Delta_t = \frac{\partial V}{\partial S}$, the portfolio dynamics become:
$d\Pi_t = \left[\frac{\partial V}{\partial t} + \frac{1}{2}\sigma^2 S_t^2 \frac{\partial^2 V}{\partial S^2}\right] dt$
:::

## Step 5: No-Arbitrage Condition

::: {.callout-important icon=false}
## Theorem 4.1 (Risk-Free Rate Condition)
Since the portfolio is risk-free, it must earn the risk-free rate to prevent arbitrage:
$d\Pi_t = r\Pi_t dt$

Substituting $\Pi_t = V - \Delta_t S_t = V - \frac{\partial V}{\partial S} S_t$:
$d\Pi_t = r\left(V - \frac{\partial V}{\partial S} S_t\right) dt$
:::

::: {.callout-note collapse="true"}
## Proof of Theorem 4.1
If a risk-free portfolio earned more than the risk-free rate, we could borrow at rate $r$, invest in the portfolio, and earn a risk-free profit (arbitrage). If it earned less, we could short the portfolio, lend at rate $r$, and again earn risk-free profit.
:::

## Step 6: Deriving the Black-Scholes PDE

::: {.callout-important icon=false}
## Theorem 4.2 (Black-Scholes Partial Differential Equation)
The option price $V(t,S)$ satisfies the Black-Scholes PDE:
$\frac{\partial V}{\partial t} + rS \frac{\partial V}{\partial S} + \frac{1}{2}\sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} - rV = 0$

with terminal condition:
$V(T,S) = (S-K)^+$
:::

::: {.callout-note collapse="true"}
## Proof of Theorem 4.2
Equating the two expressions for $d\Pi_t$:
$\frac{\partial V}{\partial t} + \frac{1}{2}\sigma^2 S_t^2 \frac{\partial^2 V}{\partial S^2} = r\left(V - \frac{\partial V}{\partial S} S_t\right)$

Rearranging:
$\frac{\partial V}{\partial t} + \frac{1}{2}\sigma^2 S_t^2 \frac{\partial^2 V}{\partial S^2} = rV - rS_t \frac{\partial V}{\partial S}$

Therefore:
$\frac{\partial V}{\partial t} + rS_t \frac{\partial V}{\partial S} + \frac{1}{2}\sigma^2 S_t^2 \frac{\partial^2 V}{\partial S^2} - rV = 0$

The terminal condition comes from the option payoff at maturity.
:::

## Step 7: Solving the PDE

To solve this PDE, we use a change of variables to transform it into the heat equation.

::: {.callout-note icon=false}
## Definition 4.4 (Variable Transformation)
Let:
\begin{align}
\tau &= T - t \quad \text{(time to maturity)} \\
x &= \ln(S/K) \quad \text{(log-moneyness)} \\
u(\tau, x) &= e^{r\tau} \frac{V(T-\tau, Ke^x)}{K}
\end{align}
:::

::: {.callout-important icon=false}
## Lemma 4.4 (Transformed PDE)
The function $u(\tau, x)$ satisfies the diffusion equation:
$\frac{\partial u}{\partial \tau} = \frac{1}{2}\sigma^2 \frac{\partial^2 u}{\partial x^2} + \left(r - \frac{\sigma^2}{2}\right) \frac{\partial u}{\partial x}$

with initial condition:
$u(0, x) = (e^x - 1)^+$
:::

::: {.callout-note collapse="true"}
## Proof of Lemma 4.4
We need to compute the partial derivatives of $V$ in terms of $u$. We have:
$V(t,S) = K e^{-r(T-t)} u(T-t, \ln(S/K))$

Let $\tau = T-t$ and $x = \ln(S/K)$. Then:

\begin{align}
\frac{\partial V}{\partial t} &= K e^{-r\tau} \left[r u - \frac{\partial u}{\partial \tau}\right] \\
\frac{\partial V}{\partial S} &= K e^{-r\tau} \frac{1}{S} \frac{\partial u}{\partial x} \\
\frac{\partial^2 V}{\partial S^2} &= K e^{-r\tau} \frac{1}{S^2} \left[\frac{\partial^2 u}{\partial x^2} - \frac{\partial u}{\partial x}\right]
\end{align}

Substituting into the Black-Scholes PDE and simplifying (after dividing by $K e^{-r\tau}$):
$-\frac{\partial u}{\partial \tau} + \left(r - \frac{\sigma^2}{2}\right) \frac{\partial u}{\partial x} + \frac{1}{2}\sigma^2 \frac{\partial^2 u}{\partial x^2} = 0$

Therefore:
$\frac{\partial u}{\partial \tau} = \frac{1}{2}\sigma^2 \frac{\partial^2 u}{\partial x^2} + \left(r - \frac{\sigma^2}{2}\right) \frac{\partial u}{\partial x}$

The initial condition at $\tau = 0$ (i.e., $t = T$) is:
$u(0, x) = \frac{(Ke^x - K)^+}{K} = (e^x - 1)^+$
:::

::: {.callout-important icon=false}
## Theorem 4.3 (Solution via Fundamental Solution)
The solution to the transformed PDE is:
$u(\tau, x) = \int_{-\infty}^{\infty} (e^y - 1)^+ G(\tau; x, y) dy$

where $G(\tau; x, y)$ is the fundamental solution:
$G(\tau; x, y) = \frac{1}{\sqrt{2\pi\sigma^2\tau}} \exp\left(-\frac{(y - x - (r-\sigma^2/2)\tau)^2}{2\sigma^2\tau}\right)$
:::

## Step 8: Computing the Solution

::: {.callout-important icon=false}
## Theorem 4.4 (Explicit Solution of the PDE)
After computing the integral (which follows the same steps as in the martingale approach), we obtain:
$u(\tau, x) = e^x \Phi(d_1) - \Phi(d_2)$

where:
\begin{align}
d_1 &= \frac{x + (r + \sigma^2/2)\tau}{\sigma\sqrt{\tau}} \\
d_2 &= \frac{x + (r - \sigma^2/2)\tau}{\sigma\sqrt{\tau}} = d_1 - \sigma\sqrt{\tau}
\end{align}
:::

::: {.callout-important icon=false}
## Theorem 4.5 (Black-Scholes Formula via PDE Method)
Transforming back to the original variables, the European call option price is:
$V(t,S) = S \Phi(d_1) - K e^{-r(T-t)} \Phi(d_2)$

where:
\begin{align}
d_1 &= \frac{\ln(S/K) + (r + \sigma^2/2)(T-t)}{\sigma\sqrt{T-t}} \\
d_2 &= d_1 - \sigma\sqrt{T-t}
\end{align}
:::

::: {.callout-note collapse="true"}
## Proof of Theorem 4.5
We have:
$V(t,S) = K e^{-r(T-t)} u(T-t, \ln(S/K))$

The transformation from the $u$ solution to the $V$ solution follows the same integration techniques as in the martingale approach. The key insight is that both methods yield identical results, demonstrating the equivalence of risk-neutral valuation and PDE approaches.
:::

# Verification and Conclusion

::: {.callout-important icon=false}
## Theorem 5.1 (Equivalence of Both Methods)
Both the martingale approach and the PDE approach yield the identical Black-Scholes formula:
$V(t,S) = S \Phi(d_1) - K e^{-r(T-t)} \Phi(d_2)$

This demonstrates the deep connection between:

- Risk-neutral valuation (martingale theory)
- Dynamic hedging and partial differential equations  
- Stochastic calculus and deterministic analysis
:::

## Economic Interpretation

::: {.callout-tip icon=false}
## Remark 5.1 (Economic Interpretation)
The Black-Scholes formula has a clear economic interpretation:

- $S \Phi(d_1)$: Expected value of the stock if exercised, weighted by probability of exercise
- $K e^{-r(T-t)} \Phi(d_2)$: Present value of strike price, weighted by probability of exercise  
- $\Phi(d_2)$: Risk-neutral probability that option finishes in-the-money
- $\Delta = \frac{\partial V}{\partial S} = \Phi(d_1)$: Hedge ratio (number of shares to hold per option)
:::

## Key Insights

::: {.callout-tip icon=false}
## Remark 5.2 (Key Insights)
The derivation reveals several fundamental insights:

1. The option price depends only on the risk-free rate $r$, not the actual expected return $\mu$ of the stock
2. Perfect hedging is possible in continuous time with continuous trading
3. The same formula emerges from completely different mathematical approaches
4. The risk-neutral measure transforms the pricing problem into an expectation calculation
:::

## Greeks and Risk Management

::: {.callout-note icon=false}
## Definition 5.1 (The Greeks)
The **Greeks** measure sensitivities of the option price to various parameters:

**Delta**: $\Delta = \frac{\partial V}{\partial S} = \Phi(d_1)$
- Measures sensitivity to stock price changes
- Represents the hedge ratio

**Gamma**: $\Gamma = \frac{\partial^2 V}{\partial S^2} = \frac{\phi(d_1)}{S\sigma\sqrt{T-t}}$
- Measures rate of change of delta
- Important for portfolio convexity

**Theta**: $\Theta = \frac{\partial V}{\partial t} = -\frac{S\phi(d_1)\sigma}{2\sqrt{T-t}} - rKe^{-r(T-t)}\Phi(d_2)$
- Measures time decay
- Always negative for long call options

**Vega**: $\nu = \frac{\partial V}{\partial \sigma} = S\phi(d_1)\sqrt{T-t}$
- Measures sensitivity to volatility changes
- Always positive for long options

**Rho**: $\rho = \frac{\partial V}{\partial r} = K(T-t)e^{-r(T-t)}\Phi(d_2)$
- Measures sensitivity to interest rate changes

where $\phi(x) = \frac{1}{\sqrt{2\pi}}e^{-x^2/2}$ is the standard normal density.
:::

## Extensions and Limitations

::: {.callout-warning icon=false}
## Remark 5.3 (Model Assumptions and Limitations)
The Black-Scholes model relies on several strong assumptions:

**Assumptions:**
- Constant risk-free rate and volatility
- No dividends
- European exercise only
- No transaction costs
- Continuous trading possible
- Log-normal stock price distribution

**Limitations:**
- Volatility smile/skew not captured
- Jump risk ignored
- Early exercise features not handled
- Transaction costs can be significant
- Liquidity constraints in practice

**Extensions:**
- American options (early exercise)
- Stochastic volatility models (Heston, etc.)
- Jump-diffusion models (Merton)
- Dividend-paying stocks
- Time-dependent parameters
:::

## Computational Implementation

::: {.callout-note icon=false}
## Example 5.1 (Python Implementation)

```python
import numpy as np
from scipy.stats import norm

def black_scholes_call(S, K, T, r, sigma):
    """
    Calculate Black-Scholes call option price
    
    Parameters:
    S: Current stock price
    K: Strike price  
    T: Time to expiration
    r: Risk-free rate
    sigma: Volatility
    """
    d1 = (np.log(S/K) + (r + 0.5*sigma**2)*T) / (sigma*np.sqrt(T))
    d2 = d1 - sigma*np.sqrt(T)
    
    call_price = S*norm.cdf(d1) - K*np.exp(-r*T)*norm.cdf(d2)
    
    return call_price

def calculate_greeks(S, K, T, r, sigma):
    """Calculate the Greeks"""
    d1 = (np.log(S/K) + (r + 0.5*sigma**2)*T) / (sigma*np.sqrt(T))
    d2 = d1 - sigma*np.sqrt(T)
    
    delta = norm.cdf(d1)
    gamma = norm.pdf(d1) / (S*sigma*np.sqrt(T))
    theta = (-S*norm.pdf(d1)*sigma/(2*np.sqrt(T)) 
             - r*K*np.exp(-r*T)*norm.cdf(d2))
    vega = S*norm.pdf(d1)*np.sqrt(T)
    rho = K*T*np.exp(-r*T)*norm.cdf(d2)
    
    return {'delta': delta, 'gamma': gamma, 'theta': theta, 'vega': vega, 'rho': rho}

# Example usage
S0 = 100    # Current stock price
K = 105     # Strike price
T = 0.25    # 3 months to expiration
r = 0.05    # 5% risk-free rate  
sigma = 0.2 # 20% volatility

price = black_scholes_call(S0, K, T, r, sigma)
greeks = calculate_greeks(S0, K, T, r, sigma)

print(f"Call option price: ${price:.2f}")
print(f"Delta: {greeks['delta']:.4f}")
print(f"Gamma: {greeks['gamma']:.4f}")
```
:::

This complete treatment of the Black-Scholes model provides both theoretical rigor and practical applicability, showing how mathematical finance bridges pure mathematics and real-world financial applications.