{"title":"Stochastic Calculus","markdown":{"yaml":{"title":"Stochastic Calculus","abstract":"Would be including the notes and topics from Shreve's and Grezelak's book as well topics that would fall into this category.Including code implementation in python based of the book.<br/><br/>DISCLAIMER THERE IS AT TIMES LOT OF HAND WAVING ,THIS IS NOT AS MATHEMATICALLY RIGOROUS AS YOU WOULD EXPECT LIKE IN A PURE MATH TEXTBOOK.","toc":true,"execute":{"eval":true,"warning":false},"format":{"html":{"html-math-method":"katex","style":"background : #020508"}}},"headingText":"Resources","containsRefs":false,"markdown":"\n\n\nThese are list of books , videos and courses that I am currently referencing for content on this page , for more detailed list please check out the resource section above.\n\n-   Mathematical modelling and computation in finance by Cornerlis Ooseterlee and Lech Grzelak (Main Text)\n\n-   Stochastic CalcuIus for Finance II Continuous-Time Models by Steven Shreve (Main Reference text)\n\n-   Stochastic Differential Equations By Bernt Oksendal\n\n## Preliminaries\n\n::: {#def-sigma}\n## $\\sigma$ algebra\n\n: Let $\\Omega$ be a nonempty set , and let $\\mathcal{F}$ be a set of collections of subsets of $\\Omega$. We say that $\\mathcal{F}$ is a $\\sigma$ algebra provided that\n\ni)  The empty set $\\emptyset$ belongs to $\\mathcal{F}$\nii) $A$ and $A^{c}$ belong to $\\mathcal{F}$ whenever A $\\in$ $\\mathcal{F}$\niii) whenever $$A_1 ,A_2 ,A_3 ..... \\in \\mathcal{F}$$ then $\\bigcup_{i=1}^\\infty A_{i} \\in \\mathcal{F}$\n:::\n\n<br/> <br/>\n\n::: {#def-ProbMeasure}\n## Probability measure\n\n: Let $\\Omega$ be a nonempty set , and let $\\mathbb{F}$ be $\\sigma$ algebra of subsets of $\\Omega$. A probability measure $\\mathbb{P}$ is a function that, to every set $A \\in \\mathcal{F}$ , assigns a number in $[0,1]$ called the probability of $A$ written as $\\mathbb{P}(A)$ .We require\n\ni)  $\\mathbb{P}(\\Omega) = 1$ and\n\nii) (Countable Additivity) Whenever $A_1,A_2,A_3....$ is a sequence of disjoint sets in $\\mathcal{F}$ , then $$\\mathbb{P}(\\bigcup_{n=1}^\\infty A_n) = \\sum_{n=1}^{\\infty} \\mathbb{P}(A_n) $$\n\n<br/> The Triple $(\\Omega, \\mathcal{F},\\mathbb{}P)$ is called probability measure\n:::\n\n<br/> From the above it follows that for finitely many disjoint sets $A_1, A_2,A_3....A_n$ $$\\mathbb{P}(\\bigcup_{n=1}^N) = \\sum_{n=1}^N \\mathbb{P}(A_n)$$\n\nand $\\mathbb{P}(A^c) = 1 - \\mathbb{P}(A)$\n\n::: {#exm-1.1 style=\"background: #020508\"}\n## Uniform(Lebesgue) measure on $[0,1]$\n\n<br/> $\\Omega = [0,1]$<br/> $\\mathbb{P}[a,b] = b-a ,0 \\leq a \\leq b \\leq1$ <br/> single points have zero probability and <br/> $(a,b)$ can be written as $$ \\bigcup_{n=1}^\\infty[a+\\frac{1}{n} , b -\\frac{1}{n}]$$\n:::\n\n<br/> <br/> The $\\sigma$-algebra beginning with closed intervals and adding everything else necessary in order to have a $\\sigma$- algebra is called a Borel $\\sigma$-algebra and denoted by $\\mathcal{B}[0,1]$. Borel $\\sigma$-algebras are $\\sigma$-algebra generated by open sets and equivalently closed sets over any topological space.\n\n::: {#def-almostsurely}\nlet $(\\Omega,\\mathcal{F},\\mathbb{P})$ be a probability space. If a set $A \\in \\mathcal{F}$ satisfies $\\mathbb{P}(A) = 1$, we say the event $A$ occurs almost surely\n:::\n\n::: {#exm-1.2 style=\"background: #020508\"}\nLet $\\mathbb{P}$ be the uniform measure as defined in example 1. Define $X(\\omega) = \\omega$ and $Y(\\omega) = 1 - \\omega$ for all $\\omega \\in [0,1]$ , then the distribution measure of X is uniform $$\\mu_{X}[a,b] = \\mathbb{P}\\{\\omega;a\\leq X(w)\\leq b\\} = \\mathbb{P}[a,b] = b-a, 0\\leq a \\leq b \\leq 1$$ by definition of $\\mathbb{P}$. <br/> Its easy to see to see that $X$ and $Y$ have the same distribution. But under the probability measure$\\mathbb{\\widetilde{P}}$ on $[0,1]$ defined by $$\\mathbb{\\widetilde{P}[a,b]} = \\int_a^b 2\\omega \\, d\\omega = b^2-a^2  , 0 \\leq a\\leq b \\leq1 $$ $X$ and $Y$ have different distributions.\n:::\n\n::: {#def-CDF}\n## cumulative distribution function and density function\n\n$$ F(x) = \\mathbb{P}\\{X \\leq x\\} , x \\in \\mathbb{R}$$ $$\\mu_X[a,b] = \\mathbb{P}\\{a \\leq X \\leq b \\} = \\int_a^b f(x) \\, dx , -\\infty < a \\leq b < \\infty$$ $f(x)$ is called the density funtion and $F(x)$ is called the cummulative distribution function.\n:::\n\n::: {#exm-1.3 style=\"background: #020508\"}\n## Standard normal random variable\n\nLet $$\\phi(x)  = \\frac {a}{\\sqrt{2\\pi}}e^{\\frac{-x^2}{2}}$$ be the standard normal density and definiing the cummulative normal distribution function as $$N(x) = \\int_{-\\infty}^x \\phi(\\xi)\\,d\\xi$$ The function $N(x)$ is strictly increasing function which is surjective onto $(0,1)$ from $\\mathbb{R}$, so it has a strictly increasing inverse function $N^{-1}(y),y \\in (0,1)$. Let $Y$ be a uniformly distributed random variable defined on some probability space $(\\Omega,\\mathcal{F},\\mathbb{P})$ and set $X = N^{-1}(Y)$ then\n\n```{=tex}\n\\begin{align*}\n\n\\mu_X[a,b] &= \\mathbb{P}\\{\\omega \\in \\Omega ; a \\leq X(\\omega) \\leq b\\} \\\\\n\n          &= \\mathbb{P}\\{\\omega \\in \\Omega ; a \\leq N^{-1}(Y(\\omega)) \\leq b\\}\\\\\n            \n          &= \\mathbb{P}\\{\\omega \\in \\Omega ; N(a) \\leq Y(\\omega) \\leq N(b) \\} \\\\\n        \n          &= N(b) - N(a) \\\\\n          &= \\int_a^b \\phi(x) \\, dx\n\n\\end{align*}\n```\nAny random variable that has this distribution regardless of the probability space is called standard normal distribution.<br/> Thing to note the use of uniformly distributed random variable for generating a standard random variable is called probability integral transform and this is commonly used in Monte Carlo simulation\n:::\n\n<br/><br/>\n\n## Stochastic Processes\n\n::: {#def}\n### Weiner process\n\nA fundamental stochastic process, which is also commonly used in the construction of stochastic differential equations (SDEs) to describe asset price movements, is the Wiener process, also called Brownian motion. Mathematically, a Wiener process, $W(t)$, is characterized by the following properties:\n\n<p style=\"font-size:15px\">\n\n<br>$a)\\quad W(t\\_{0}) = 0 (technically:\\mathbb{P}[W(t_0)=0] =1)$</br> <br>$b)\\quad W(t) is\\quad almost \\quad surely \\quad continous$</br> <br>$c)\\quad W(t) \\quad has \\quad independent \\quad incerements \\quad with \\quad distribution\\quad W(t)- W(s) \\sim \\mathcal{N}(0,t-s)$</br>\n\n</p>\n:::\n\n<br/><br/>\n\n## Black-Scholes model\n\n<!-- --- -->\n<!-- title: \"Complete Black-Scholes Proofs: From First Principles\" -->\n<!-- author: \"\" -->\n<!-- date: today -->\n<!-- format: -->\n<!--   html: -->\n<!--     toc: true -->\n<!--     toc-depth: 3 -->\n<!--     number-sections: true -->\n<!--     html-math-method: mathjax -->\n<!--   pdf: -->\n<!--     toc: true -->\n<!--     number-sections: true -->\n<!--     geometry: -->\n<!--       - top=1in -->\n<!--       - left=1in -->\n<!--       - right=1in -->\n<!--       - bottom=1in -->\n<!-- --- -->\n\n# Part I: Mathematical Foundations and Definitions\n\nThis section establishes all the mathematical machinery needed for the Black-Scholes proofs. We assume knowledge of measure theory and basic stochastic calculus but will define all financial and probabilistic concepts explicitly.\n\n## Financial Market Framework\n\n::: {.callout-note icon=false}\n## Definition 1.1 (Financial Market)\nA financial market consists of:\n\n1. A probability space $(\\Omega, \\mathcal{F}, \\mathbb{P})$ where $\\Omega$ represents all possible market scenarios\n2. A filtration $\\{\\mathcal{F}_t\\}_{t \\geq 0}$ representing information available at time $t$\n3. A finite collection of traded assets with price processes $\\{S^i_t\\}_{i=0,1,\\ldots,n}$\n:::\n\n::: {.callout-note icon=false}\n## Definition 1.2 (Brownian Motion)\nA stochastic process $\\{W_t\\}_{t \\geq 0}$ on $(\\Omega, \\mathcal{F}, \\mathbb{P})$ is a standard Brownian motion if:\n\n1. $W_0 = 0$ almost surely\n2. $W$ has independent increments: for $0 \\leq s < t$, $W_t - W_s$ is independent of $\\mathcal{F}_s$\n3. $W_t - W_s \\sim N(0, t-s)$ for all $0 \\leq s < t$\n4. $W$ has continuous sample paths almost surely\n:::\n\n::: {.callout-note icon=false}\n## Definition 1.3 (Natural Filtration of Brownian Motion)\nThe natural filtration of Brownian motion is \n$$\\mathcal{F}_t^W = \\sigma(W_s : 0 \\leq s \\leq t)$$\nthe $\\sigma$-algebra generated by the Brownian motion up to time $t$.\n:::\n\n::: {.callout-note icon=false}\n## Definition 1.4 (Adapted Process)\nA stochastic process $\\{X_t\\}_{t \\geq 0}$ is adapted to the filtration $\\{\\mathcal{F}_t\\}$ if $X_t$ is $\\mathcal{F}_t$-measurable for all $t \\geq 0$.\n:::\n\n::: {.callout-note icon=false}\n## Definition 1.5 (Geometric Brownian Motion)\nA process $\\{S_t\\}_{t \\geq 0}$ follows geometric Brownian motion with parameters $\\mu \\in \\mathbb{R}$ and $\\sigma > 0$ if it satisfies the stochastic differential equation:\n$$dS_t = \\mu S_t \\, dt + \\sigma S_t \\, dW_t$$\nwith initial condition $S_0 > 0$.\n:::\n\n::: {.callout-tip}\n## Remark 1.1\nThe explicit solution to geometric Brownian motion is:\n$$S_t = S_0 \\exp\\left(\\left(\\mu - \\frac{\\sigma^2}{2}\\right)t + \\sigma W_t\\right)$$\nThis can be verified using It√¥'s lemma on $f(t,x) = \\ln x$.\n:::\n\n## Portfolio and Trading Strategy Concepts\n\n::: {.callout-note icon=false}\n## Definition 1.6 (Trading Strategy)\nA trading strategy is a pair of adapted processes $(\\phi^0_t, \\phi^1_t)$ where:\n\n- $\\phi^0_t$ represents the number of units of the bond held at time $t$\n- $\\phi^1_t$ represents the number of shares of stock held at time $t$\n\nBoth processes must be adapted to the filtration $\\{\\mathcal{F}_t\\}$.\n:::\n\n::: {.callout-note icon=false}\n## Definition 1.7 (Portfolio Value)\nThe value of a portfolio with trading strategy $(\\phi^0_t, \\phi^1_t)$ at time $t$ is:\n$$V_t = \\phi^0_t B_t + \\phi^1_t S_t$$\nwhere $B_t$ is the bond price and $S_t$ is the stock price.\n:::\n\n::: {.callout-note icon=false}\n## Definition 1.8 (Self-Financing Strategy)\nA trading strategy $(\\phi^0_t, \\phi^1_t)$ is self-financing if:\n$$dV_t = \\phi^0_t dB_t + \\phi^1_t dS_t$$\nThis means no money is added or withdrawn from the portfolio; changes in value come only from price movements of held assets.\n:::\n\n::: {.callout-note icon=false}\n## Definition 1.9 (Arbitrage Opportunity)\nAn arbitrage opportunity is a self-financing trading strategy with:\n\n1. Initial value $V_0 = 0$\n2. $\\mathbb{P}(V_T \\geq 0) = 1$ for some time $T > 0$\n3. $\\mathbb{P}(V_T > 0) > 0$\n:::\n\n::: {.callout-note icon=false}\n## Definition 1.10 (Arbitrage-Free Market)\nA market is arbitrage-free if no arbitrage opportunities exist.\n:::\n\n## Martingale Theory for Finance\n\n::: {.callout-note icon=false}\n## Definition 1.11 (Martingale)\nAn adapted process $\\{M_t\\}_{t \\geq 0}$ is a martingale with respect to filtration $\\{\\mathcal{F}_t\\}$ and probability measure $\\mathbb{P}$ if:\n\n1. $\\mathbb{E}[|M_t|] < \\infty$ for all $t \\geq 0$\n2. $\\mathbb{E}[M_t | \\mathcal{F}_s] = M_s$ for all $0 \\leq s \\leq t$\n:::\n\n::: {.callout-note icon=false}\n## Definition 1.12 (Equivalent Probability Measures)\nTwo probability measures $\\mathbb{P}$ and $\\mathbb{Q}$ on $(\\Omega, \\mathcal{F})$ are equivalent (written $\\mathbb{P} \\sim \\mathbb{Q}$) if they have the same null sets:\n$$\\mathbb{P}(A) = 0 \\iff \\mathbb{Q}(A) = 0 \\text{ for all } A \\in \\mathcal{F}$$\n:::\n\n::: {.callout-note icon=false}\n## Definition 1.13 (Radon-Nikodym Derivative)\nIf $\\mathbb{Q} \\ll \\mathbb{P}$ (Q is absolutely continuous with respect to P), then there exists a non-negative $\\mathcal{F}$-measurable random variable $Z$ such that:\n$$\\mathbb{Q}(A) = \\int_A Z \\, d\\mathbb{P} \\text{ for all } A \\in \\mathcal{F}$$\nWe write $Z = \\frac{d\\mathbb{Q}}{d\\mathbb{P}}$ and call $Z$ the Radon-Nikodym derivative.\n:::\n\n::: {.callout-important icon=false}\n## Theorem 1.1 (Girsanov's Theorem - Statement)\nLet $\\theta$ be an adapted process with $\\int_0^T \\theta_s^2 \\, ds < \\infty$ almost surely. Define:\n$$Z_t = \\exp\\left(-\\int_0^t \\theta_s \\, dW_s - \\frac{1}{2}\\int_0^t \\theta_s^2 \\, ds\\right)$$\n\nIf $\\mathbb{E}[Z_T] = 1$, then:\n\n1. The process $Z_t$ is a martingale\n2. The measure $\\mathbb{Q}$ defined by $\\frac{d\\mathbb{Q}}{d\\mathbb{P}} = Z_T$ is a probability measure equivalent to $\\mathbb{P}$\n3. Under $\\mathbb{Q}$, the process $\\tilde{W}_t = W_t + \\int_0^t \\theta_s \\, ds$ is a Brownian motion\n:::\n\n::: {.callout-note icon=false}\n## Definition 1.14 (Risk-Neutral Measure)\nIn a financial market with bond $B_t = e^{rt}$ and stock following \n$$dS_t = \\mu S_t \\, dt + \\sigma S_t \\, dW_t$$\na probability measure $\\mathbb{Q}$ equivalent to $\\mathbb{P}$ is called risk-neutral if the discounted stock price $e^{-rt}S_t$ is a $\\mathbb{Q}$-martingale.\n:::\n\n## Options and Derivatives\n\n::: {.callout-note icon=false}\n## Definition 1.15 (European Option)\nA European option is a financial contract that gives the holder the right (but not obligation) to:\n\n- **Call option**: Buy an asset at strike price $K$ at maturity time $T$\n- **Put option**: Sell an asset at strike price $K$ at maturity time $T$\n:::\n\n::: {.callout-note icon=false}\n## Definition 1.16 (Option Payoff)\nThe payoff of a European option at maturity $T$ is:\n\n- **Call**: $h(S_T) = (S_T - K)^+ = \\max(S_T - K, 0)$\n- **Put**: $h(S_T) = (K - S_T)^+ = \\max(K - S_T, 0)$\n\nwhere $S_T$ is the stock price at maturity.\n:::\n\n::: {.callout-note icon=false}\n## Definition 1.17 (Option Price)\nThe price of an option at time $t$ is denoted $V(t, S_t)$ and depends on the current time $t$ and current stock price $S_t$.\n:::\n\n::: {.callout-note icon=false}\n## Definition 1.18 (Replicating Portfolio)\nA replicating portfolio for an option is a self-financing trading strategy $(\\phi^0_t, \\phi^1_t)$ such that the portfolio value at maturity equals the option payoff:\n$$V_T = \\phi^0_T B_T + \\phi^1_T S_T = h(S_T)$$\n:::\n\n## Fundamental Theorems of Asset Pricing\n\n::: {.callout-important icon=false}\n## Theorem 1.2 (First Fundamental Theorem of Asset Pricing)\nA market is arbitrage-free if and only if there exists a probability measure $\\mathbb{Q}$ equivalent to $\\mathbb{P}$ such that all discounted asset prices are $\\mathbb{Q}$-martingales.\n:::\n\n::: {.callout-important icon=false}\n## Theorem 1.3 (Second Fundamental Theorem of Asset Pricing)\nAn arbitrage-free market is complete if and only if the risk-neutral measure is unique.\n:::\n\n::: {.callout-note icon=false}\n## Definition 1.19 (Complete Market)\nA market is complete if every contingent claim (option payoff) can be replicated by a self-financing trading strategy.\n:::\n\n::: {.callout-important icon=false}\n## Theorem 1.4 (Risk-Neutral Valuation Principle)\nIn an arbitrage-free complete market, the price of any attainable contingent claim $h(S_T)$ at time $t$ is:\n$$V(t, S_t) = e^{-r(T-t)} \\mathbb{E}_\\mathbb{Q}[h(S_T) | \\mathcal{F}_t]$$\nwhere $\\mathbb{Q}$ is the unique risk-neutral measure.\n:::\n\n# Part II: The Black-Scholes Model Setup\n\n## Model Specification\n\nWe consider a financial market on a probability space $(\\Omega, \\mathcal{F}, \\mathbb{P})$ with filtration $\\{\\mathcal{F}_t\\}_{t \\geq 0}$ and two traded assets:\n\n::: {.callout-note icon=false}\n## Definition 2.1 (Black-Scholes Market Model)\nThe Black-Scholes market consists of:\n\n1. **Risk-free bond**: $dB_t = rB_t \\, dt$ with $B_0 = 1$, giving $B_t = e^{rt}$\n2. **Risky stock**: $dS_t = \\mu S_t \\, dt + \\sigma S_t \\, dW_t$ with $S_0 > 0$\n\nwhere:\n\n- $r > 0$ is the constant risk-free interest rate\n- $\\mu \\in \\mathbb{R}$ is the stock's expected return (drift)\n- $\\sigma > 0$ is the stock's volatility\n- $\\{W_t\\}_{t \\geq 0}$ is a standard Brownian motion adapted to $\\{\\mathcal{F}_t\\}$\n:::\n\n::: {.callout-note icon=false}\n## Definition 2.2 (European Call Option in Black-Scholes Model)\nWe consider a European call option with:\n\n- Strike price $K > 0$\n- Maturity time $T > 0$  \n- Payoff at maturity: $h(S_T) = (S_T - K)^+$\n\nOur goal is to find the option price $V(t, S_t)$ for $0 \\leq t \\leq T$.\n:::\n\n## Key Properties of the Model\n\n::: {.callout-important icon=false}\n## Lemma 2.1 (Stock Price Solution)\nThe solution to the stock price SDE $dS_t = \\mu S_t \\, dt + \\sigma S_t \\, dW_t$ is:\n$$S_t = S_0 \\exp\\left(\\left(\\mu - \\frac{\\sigma^2}{2}\\right)t + \\sigma W_t\\right)$$\n:::\n\n::: {.callout-note collapse=\"true\"}\n## Proof of Lemma 2.1\nLet $Y_t = \\ln S_t$. By It√¥'s lemma with $f(x) = \\ln x$:\n\n\\begin{align}\ndY_t &= f'(S_t) dS_t + \\frac{1}{2}f''(S_t)(dS_t)^2 \\\\\n&= \\frac{1}{S_t} dS_t + \\frac{1}{2}\\left(-\\frac{1}{S_t^2}\\right)(dS_t)^2 \\\\\n&= \\frac{1}{S_t}(\\mu S_t \\, dt + \\sigma S_t \\, dW_t) - \\frac{1}{2S_t^2}(\\sigma S_t)^2 dt \\\\\n&= \\mu \\, dt + \\sigma \\, dW_t - \\frac{\\sigma^2}{2} dt \\\\\n&= \\left(\\mu - \\frac{\\sigma^2}{2}\\right) dt + \\sigma \\, dW_t\n\\end{align}\n\nIntegrating from $0$ to $t$:\n$$Y_t = Y_0 + \\left(\\mu - \\frac{\\sigma^2}{2}\\right)t + \\sigma W_t$$\n\nSince $Y_t = \\ln S_t$ and $Y_0 = \\ln S_0$:\n$$\\ln S_t = \\ln S_0 + \\left(\\mu - \\frac{\\sigma^2}{2}\\right)t + \\sigma W_t$$\n\nTherefore:\n$$S_t = S_0 \\exp\\left(\\left(\\mu - \\frac{\\sigma^2}{2}\\right)t + \\sigma W_t\\right)$$\n:::\n\n::: {.callout-important icon=false}\n## Corollary 2.1 (Log-Normal Distribution of Stock Price)\nUnder $\\mathbb{P}$, we have:\n$$\\ln(S_t/S_0) \\sim N\\left(\\left(\\mu - \\frac{\\sigma^2}{2}\\right)t, \\sigma^2 t\\right)$$\n:::\n\n# Part III: Proof via Martingale Approach\n\n## Step 1: Construction of Risk-Neutral Measure\n\n::: {.callout-important icon=false}\n## Theorem 3.1 (Existence of Risk-Neutral Measure in Black-Scholes)\nThere exists a unique probability measure $\\mathbb{Q}$ equivalent to $\\mathbb{P}$ such that the discounted stock price $e^{-rt}S_t$ is a $\\mathbb{Q}$-martingale.\n:::\n\n::: {.callout-note collapse=\"true\"}\n## Proof of Theorem 3.1\n\n**Step 1**: Define the market price of risk:\n$$\\theta = \\frac{\\mu - r}{\\sigma}$$\n\nThis is the constant that will appear in Girsanov's theorem.\n\n**Step 2**: Define the Radon-Nikodym density process:\n\\begin{align}\nZ_t &= \\exp\\left(-\\theta W_t - \\frac{1}{2}\\theta^2 t\\right) \\\\\n&= \\exp\\left(-\\frac{\\mu - r}{\\sigma} W_t - \\frac{1}{2}\\left(\\frac{\\mu - r}{\\sigma}\\right)^2 t\\right)\n\\end{align}\n\n**Step 3**: Verify that $Z_t$ is a martingale and $\\mathbb{E}[Z_T] = 1$.\n\nSince $\\theta$ is constant, we can compute:\n$$\\mathbb{E}[Z_t] = \\mathbb{E}\\left[\\exp\\left(-\\theta W_t - \\frac{1}{2}\\theta^2 t\\right)\\right]$$\n\nSince $W_t \\sim N(0,t)$ under $\\mathbb{P}$:\n\\begin{align}\n\\mathbb{E}[Z_t] &= \\int_{-\\infty}^{\\infty} \\exp\\left(-\\theta w - \\frac{1}{2}\\theta^2 t\\right) \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{w^2}{2t}\\right) dw \\\\\n&= \\exp\\left(-\\frac{1}{2}\\theta^2 t\\right) \\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{w^2 + 2\\theta tw}{2t}\\right) dw \\\\\n&= \\exp\\left(-\\frac{1}{2}\\theta^2 t\\right) \\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{(w + \\theta t)^2 - \\theta^2 t^2}{2t}\\right) dw \\\\\n&= \\exp\\left(-\\frac{1}{2}\\theta^2 t\\right) \\exp\\left(\\frac{1}{2}\\theta^2 t\\right) \\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{(w + \\theta t)^2}{2t}\\right) dw \\\\\n&= 1\n\\end{align}\n\nThe last integral equals 1 since it's the integral of a normal density.\n\n**Step 4**: Define $\\mathbb{Q}$ by $\\frac{d\\mathbb{Q}}{d\\mathbb{P}} = Z_T$.\n\n**Step 5**: Apply Girsanov's theorem. Under $\\mathbb{Q}$, the process:\n$$\\tilde{W}_t = W_t + \\int_0^t \\theta \\, ds = W_t + \\theta t$$\nis a $\\mathbb{Q}$-Brownian motion.\n\n**Step 6**: Transform the stock price dynamics. Under $\\mathbb{Q}$:\n\\begin{align}\ndS_t &= \\mu S_t \\, dt + \\sigma S_t \\, dW_t \\\\\n&= \\mu S_t \\, dt + \\sigma S_t (d\\tilde{W}_t - \\theta \\, dt) \\\\\n&= \\mu S_t \\, dt + \\sigma S_t \\, d\\tilde{W}_t - \\sigma S_t \\theta \\, dt \\\\\n&= (\\mu - \\sigma\\theta) S_t \\, dt + \\sigma S_t \\, d\\tilde{W}_t \\\\\n&= \\left(\\mu - \\sigma \\cdot \\frac{\\mu - r}{\\sigma}\\right) S_t \\, dt + \\sigma S_t \\, d\\tilde{W}_t \\\\\n&= r S_t \\, dt + \\sigma S_t \\, d\\tilde{W}_t\n\\end{align}\n\n**Step 7**: Verify the martingale property. The discounted stock price is:\n$$e^{-rt}S_t$$\n\nIts differential is:\n\\begin{align}\nd(e^{-rt}S_t) &= -re^{-rt}S_t \\, dt + e^{-rt} dS_t \\\\\n&= -re^{-rt}S_t \\, dt + e^{-rt}(rS_t \\, dt + \\sigma S_t \\, d\\tilde{W}_t) \\\\\n&= e^{-rt}\\sigma S_t \\, d\\tilde{W}_t\n\\end{align}\n\nSince this has no $dt$ term, $e^{-rt}S_t$ is a $\\mathbb{Q}$-martingale.\n:::\n\n## Step 2: Stock Price Under Risk-Neutral Measure\n\n::: {.callout-important icon=false}\n## Lemma 3.1 (Stock Price Solution Under $\\mathbb{Q}$)\nUnder the risk-neutral measure $\\mathbb{Q}$, the stock price has the explicit form:\n$$S_t = S_0 \\exp\\left(\\left(r - \\frac{\\sigma^2}{2}\\right)t + \\sigma \\tilde{W}_t\\right)$$\nwhere $\\tilde{W}_t$ is a $\\mathbb{Q}$-Brownian motion.\n:::\n\n::: {.callout-note collapse=\"true\"}\n## Proof of Lemma 3.1\nUnder $\\mathbb{Q}$, the stock follows:\n$$dS_t = rS_t \\, dt + \\sigma S_t \\, d\\tilde{W}_t$$\n\nUsing the same technique as in the original measure, let $Y_t = \\ln S_t$:\n\\begin{align}\ndY_t &= \\frac{1}{S_t} dS_t - \\frac{1}{2S_t^2}(dS_t)^2 \\\\\n&= \\frac{1}{S_t}(rS_t \\, dt + \\sigma S_t \\, d\\tilde{W}_t) - \\frac{1}{2S_t^2}(\\sigma S_t)^2 dt \\\\\n&= r \\, dt + \\sigma \\, d\\tilde{W}_t - \\frac{\\sigma^2}{2} dt \\\\\n&= \\left(r - \\frac{\\sigma^2}{2}\\right) dt + \\sigma \\, d\\tilde{W}_t\n\\end{align}\n\nIntegrating:\n$$Y_t = Y_0 + \\left(r - \\frac{\\sigma^2}{2}\\right)t + \\sigma \\tilde{W}_t$$\n\nTherefore:\n$$S_t = S_0 \\exp\\left(\\left(r - \\frac{\\sigma^2}{2}\\right)t + \\sigma \\tilde{W}_t\\right)$$\n:::\n\n## Step 3: Risk-Neutral Valuation\n\n::: {.callout-important icon=false}\n## Theorem 3.2 (Risk-Neutral Option Pricing)\nThe price of the European call option at time $t$ is:\n$$V(t, S_t) = e^{-r(T-t)} \\mathbb{E}_\\mathbb{Q}[(S_T - K)^+ | \\mathcal{F}_t]$$\n:::\n\n::: {.callout-note collapse=\"true\"}\n## Proof of Theorem 3.2\nThis follows directly from the risk-neutral valuation principle. In an arbitrage-free complete market, the option price equals the discounted expected payoff under the risk-neutral measure.\n:::\n\n## Step 4: Computing the Expectation\n\n::: {.callout-important icon=false}\n## Theorem 3.3 (Black-Scholes Formula via Martingale Method)\nThe European call option price is:\n$$V(t, S_t) = S_t \\Phi(d_1) - K e^{-r(T-t)} \\Phi(d_2)$$\nwhere:\n\\begin{align}\nd_1 &= \\frac{\\ln(S_t/K) + (r + \\sigma^2/2)(T-t)}{\\sigma\\sqrt{T-t}} \\\\\nd_2 &= d_1 - \\sigma\\sqrt{T-t} = \\frac{\\ln(S_t/K) + (r - \\sigma^2/2)(T-t)}{\\sigma\\sqrt{T-t}}\n\\end{align}\nand $\\Phi$ is the cumulative distribution function of the standard normal distribution.\n:::\n\n::: {.callout-note collapse=\"true\"}\n## Proof of Theorem 3.3\n\n**Step 1**: Express the stock price at maturity.\nUnder $\\mathbb{Q}$, using the strong Markov property:\n$$S_T = S_t \\exp\\left(\\left(r - \\frac{\\sigma^2}{2}\\right)(T-t) + \\sigma (\\tilde{W}_T - \\tilde{W}_t)\\right)$$\n\nSince $\\tilde{W}_T - \\tilde{W}_t \\sim N(0, T-t)$ under $\\mathbb{Q}$, let $Z \\sim N(0,1)$. Then:\n$$S_T = S_t \\exp\\left(\\left(r - \\frac{\\sigma^2}{2}\\right)(T-t) + \\sigma\\sqrt{T-t} \\cdot Z\\right)$$\n\n**Step 2**: Set up the expectation.\n\\begin{align}\nV(t, S_t) &= e^{-r(T-t)} \\mathbb{E}_\\mathbb{Q}[(S_T - K)^+ | \\mathcal{F}_t] \\\\\n&= e^{-r(T-t)} \\mathbb{E}_\\mathbb{Q}\\left[\\left(S_t e^{(r-\\sigma^2/2)(T-t) + \\sigma\\sqrt{T-t} Z} - K\\right)^+\\right]\n\\end{align}\n\n**Step 3**: Find the exercise region.\nThe option is exercised when $S_T > K$, i.e., when:\n$$S_t e^{(r-\\sigma^2/2)(T-t) + \\sigma\\sqrt{T-t} Z} > K$$\n\nTaking logarithms:\n\\begin{align}\n&(r-\\sigma^2/2)(T-t) + \\sigma\\sqrt{T-t} Z > \\ln(K/S_t) \\\\\n&Z > \\frac{\\ln(K/S_t) - (r-\\sigma^2/2)(T-t)}{\\sigma\\sqrt{T-t}} = -d_2\n\\end{align}\n\n**Step 4**: Evaluate the integral.\n\\begin{align}\nV(t, S_t) &= e^{-r(T-t)} \\int_{-d_2}^{\\infty} \\left(S_t e^{(r-\\sigma^2/2)(T-t) + \\sigma\\sqrt{T-t} z} - K\\right) \\\\\n&\\quad \\times \\frac{1}{\\sqrt{2\\pi}} e^{-z^2/2} dz \\\\\n&= e^{-r(T-t)} S_t e^{(r-\\sigma^2/2)(T-t)} \\int_{-d_2}^{\\infty} e^{\\sigma\\sqrt{T-t} z} \\frac{1}{\\sqrt{2\\pi}} e^{-z^2/2} dz \\\\\n&\\quad - e^{-r(T-t)} K \\int_{-d_2}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} e^{-z^2/2} dz\n\\end{align}\n\n**Step 5**: Evaluate the first integral.\nFor the first integral, complete the square in the exponent:\n$$\\sigma\\sqrt{T-t} z - \\frac{z^2}{2} = -\\frac{1}{2}(z - \\sigma\\sqrt{T-t})^2 + \\frac{\\sigma^2(T-t)}{2}$$\n\nTherefore:\n\\begin{align}\n&\\int_{-d_2}^{\\infty} e^{\\sigma\\sqrt{T-t} z} \\frac{1}{\\sqrt{2\\pi}} e^{-z^2/2} dz \\\\\n&= e^{\\sigma^2(T-t)/2} \\int_{-d_2}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} e^{-(z-\\sigma\\sqrt{T-t})^2/2} dz \\\\\n&= e^{\\sigma^2(T-t)/2} \\int_{-d_2-\\sigma\\sqrt{T-t}}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} e^{-u^2/2} du \\\\\n&= e^{\\sigma^2(T-t)/2} \\Phi(d_2 + \\sigma\\sqrt{T-t}) \\\\\n&= e^{\\sigma^2(T-t)/2} \\Phi(d_1)\n\\end{align}\n\nwhere we used the substitution $u = z - \\sigma\\sqrt{T-t}$ and the fact that:\n$$d_2 + \\sigma\\sqrt{T-t} = d_1$$\n\n**Step 6**: Evaluate the second integral.\n$$\\int_{-d_2}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} e^{-z^2/2} dz = \\Phi(d_2)$$\n\n**Step 7**: Combine the results.\n\\begin{align}\nV(t, S_t) &= e^{-r(T-t)} S_t e^{(r-\\sigma^2/2)(T-t)} e^{\\sigma^2(T-t)/2} \\Phi(d_1) - e^{-r(T-t)} K \\Phi(d_2) \\\\\n&= S_t e^{-r(T-t)} e^{(r-\\sigma^2/2)(T-t)} e^{\\sigma^2(T-t)/2} \\Phi(d_1) - K e^{-r(T-t)} \\Phi(d_2) \\\\\n&= S_t e^{-r(T-t) + r(T-t) - \\sigma^2(T-t)/2 + \\sigma^2(T-t)/2} \\Phi(d_1) - K e^{-r(T-t)} \\Phi(d_2) \\\\\n&= S_t \\Phi(d_1) - K e^{-r(T-t)} \\Phi(d_2)\n\\end{align}\n:::\n\n# Part IV: Proof via PDE Approach\n\n## Step 1: Delta Hedging Strategy\n\n::: {.callout-note icon=false}\n## Definition 4.1 (Delta Hedging Portfolio)\nConsider a portfolio $\\Pi_t$ consisting of:\n\n- Long position: 1 unit of the option with value $V(t, S_t)$\n- Short position: $\\Delta_t$ shares of the stock\n- Cash position: The remaining value invested in bonds\n\nThe portfolio value is:\n$\\Pi_t = V(t, S_t) - \\Delta_t S_t$\n:::\n\n::: {.callout-note icon=false}\n## Definition 4.2 (Delta)\nThe delta $\\Delta_t$ represents the hedge ratio - the number of shares of stock to short for each option held. We will determine $\\Delta_t$ to make the portfolio risk-free.\n:::\n\n## Step 2: Application of It√¥'s Lemma to Option Value\n\n::: {.callout-important icon=false}\n## Lemma 4.1 (Stochastic Differential of Option Value)\nAssume the option price has the form $V(t, S_t)$ where $V \\in C^{1,2}([0,T] \\times (0,\\infty))$. Then by It√¥'s lemma:\n\\begin{align}\ndV &= \\frac{\\partial V}{\\partial t} dt + \\frac{\\partial V}{\\partial S} dS_t + \\frac{1}{2}\\frac{\\partial^2 V}{\\partial S^2} (dS_t)^2 \\\\\n&= \\left[\\frac{\\partial V}{\\partial t} + \\mu S_t \\frac{\\partial V}{\\partial S} + \\frac{1}{2}\\sigma^2 S_t^2 \\frac{\\partial^2 V}{\\partial S^2}\\right] dt + \\sigma S_t \\frac{\\partial V}{\\partial S} dW_t\n\\end{align}\n:::\n\n::: {.callout-note collapse=\"true\"}\n## Proof of Lemma 4.1\nSince $dS_t = \\mu S_t \\, dt + \\sigma S_t \\, dW_t$, we have:\n$(dS_t)^2 = (\\mu S_t \\, dt + \\sigma S_t \\, dW_t)^2 = \\sigma^2 S_t^2 (dW_t)^2 = \\sigma^2 S_t^2 dt$\n\nwhere we used the fact that $(dW_t)^2 = dt$, $dt \\cdot dW_t = 0$, and $(dt)^2 = 0$.\n\nApplying It√¥'s lemma:\n\\begin{align}\ndV &= \\frac{\\partial V}{\\partial t} dt + \\frac{\\partial V}{\\partial S} dS_t + \\frac{1}{2}\\frac{\\partial^2 V}{\\partial S^2} (dS_t)^2 \\\\\n&= \\frac{\\partial V}{\\partial t} dt + \\frac{\\partial V}{\\partial S} (\\mu S_t \\, dt + \\sigma S_t \\, dW_t) + \\frac{1}{2}\\frac{\\partial^2 V}{\\partial S^2} \\sigma^2 S_t^2 dt \\\\\n&= \\left[\\frac{\\partial V}{\\partial t} + \\mu S_t \\frac{\\partial V}{\\partial S} + \\frac{1}{2}\\sigma^2 S_t^2 \\frac{\\partial^2 V}{\\partial S^2}\\right] dt + \\sigma S_t \\frac{\\partial V}{\\partial S} dW_t\n\\end{align}\n:::\n\n## Step 3: Portfolio Dynamics\n\n::: {.callout-important icon=false}\n## Lemma 4.2 (Portfolio Value Dynamics)\nThe change in portfolio value is:\n\\begin{align}\nd\\Pi_t &= dV - \\Delta_t dS_t \\\\\n&= \\left[\\frac{\\partial V}{\\partial t} + \\mu S_t \\left(\\frac{\\partial V}{\\partial S} - \\Delta_t\\right) + \\frac{1}{2}\\sigma^2 S_t^2 \\frac{\\partial^2 V}{\\partial S^2}\\right] dt \\\\\n&\\quad + \\sigma S_t \\left(\\frac{\\partial V}{\\partial S} - \\Delta_t\\right) dW_t\n\\end{align}\n:::\n\n::: {.callout-note collapse=\"true\"}\n## Proof of Lemma 4.2\nWe have:\n\\begin{align}\nd\\Pi_t &= dV - \\Delta_t dS_t \\\\\n&= \\left[\\frac{\\partial V}{\\partial t} + \\mu S_t \\frac{\\partial V}{\\partial S} + \\frac{1}{2}\\sigma^2 S_t^2 \\frac{\\partial^2 V}{\\partial S^2}\\right] dt + \\sigma S_t \\frac{\\partial V}{\\partial S} dW_t \\\\\n&\\quad - \\Delta_t (\\mu S_t dt + \\sigma S_t dW_t) \\\\\n&= \\left[\\frac{\\partial V}{\\partial t} + \\mu S_t \\frac{\\partial V}{\\partial S} + \\frac{1}{2}\\sigma^2 S_t^2 \\frac{\\partial^2 V}{\\partial S^2} - \\Delta_t \\mu S_t\\right] dt \\\\\n&\\quad + \\sigma S_t \\left(\\frac{\\partial V}{\\partial S} - \\Delta_t\\right) dW_t \\\\\n&= \\left[\\frac{\\partial V}{\\partial t} + \\mu S_t \\left(\\frac{\\partial V}{\\partial S} - \\Delta_t\\right) + \\frac{1}{2}\\sigma^2 S_t^2 \\frac{\\partial^2 V}{\\partial S^2}\\right] dt \\\\\n&\\quad + \\sigma S_t \\left(\\frac{\\partial V}{\\partial S} - \\Delta_t\\right) dW_t\n\\end{align}\n:::\n\n## Step 4: Eliminating Risk\n\n::: {.callout-note icon=false}\n## Definition 4.3 (Delta-Neutral Portfolio)\nTo eliminate the stochastic component, we choose:\n$\\Delta_t = \\frac{\\partial V}{\\partial S}$\n\nThis choice makes the portfolio instantaneously risk-free.\n:::\n\n::: {.callout-important icon=false}\n## Lemma 4.3 (Risk-Free Portfolio Dynamics)\nWith $\\Delta_t = \\frac{\\partial V}{\\partial S}$, the portfolio dynamics become:\n$d\\Pi_t = \\left[\\frac{\\partial V}{\\partial t} + \\frac{1}{2}\\sigma^2 S_t^2 \\frac{\\partial^2 V}{\\partial S^2}\\right] dt$\n:::\n\n## Step 5: No-Arbitrage Condition\n\n::: {.callout-important icon=false}\n## Theorem 4.1 (Risk-Free Rate Condition)\nSince the portfolio is risk-free, it must earn the risk-free rate to prevent arbitrage:\n$d\\Pi_t = r\\Pi_t dt$\n\nSubstituting $\\Pi_t = V - \\Delta_t S_t = V - \\frac{\\partial V}{\\partial S} S_t$:\n$d\\Pi_t = r\\left(V - \\frac{\\partial V}{\\partial S} S_t\\right) dt$\n:::\n\n::: {.callout-note collapse=\"true\"}\n## Proof of Theorem 4.1\nIf a risk-free portfolio earned more than the risk-free rate, we could borrow at rate $r$, invest in the portfolio, and earn a risk-free profit (arbitrage). If it earned less, we could short the portfolio, lend at rate $r$, and again earn risk-free profit.\n:::\n\n## Step 6: Deriving the Black-Scholes PDE\n\n::: {.callout-important icon=false}\n## Theorem 4.2 (Black-Scholes Partial Differential Equation)\nThe option price $V(t,S)$ satisfies the Black-Scholes PDE:\n$\\frac{\\partial V}{\\partial t} + rS \\frac{\\partial V}{\\partial S} + \\frac{1}{2}\\sigma^2 S^2 \\frac{\\partial^2 V}{\\partial S^2} - rV = 0$\n\nwith terminal condition:\n$V(T,S) = (S-K)^+$\n:::\n\n::: {.callout-note collapse=\"true\"}\n## Proof of Theorem 4.2\nEquating the two expressions for $d\\Pi_t$:\n$\\frac{\\partial V}{\\partial t} + \\frac{1}{2}\\sigma^2 S_t^2 \\frac{\\partial^2 V}{\\partial S^2} = r\\left(V - \\frac{\\partial V}{\\partial S} S_t\\right)$\n\nRearranging:\n$\\frac{\\partial V}{\\partial t} + \\frac{1}{2}\\sigma^2 S_t^2 \\frac{\\partial^2 V}{\\partial S^2} = rV - rS_t \\frac{\\partial V}{\\partial S}$\n\nTherefore:\n$\\frac{\\partial V}{\\partial t} + rS_t \\frac{\\partial V}{\\partial S} + \\frac{1}{2}\\sigma^2 S_t^2 \\frac{\\partial^2 V}{\\partial S^2} - rV = 0$\n\nThe terminal condition comes from the option payoff at maturity.\n:::\n\n## Step 7: Solving the PDE\n\nTo solve this PDE, we use a change of variables to transform it into the heat equation.\n\n::: {.callout-note icon=false}\n## Definition 4.4 (Variable Transformation)\nLet:\n\\begin{align}\n\\tau &= T - t \\quad \\text{(time to maturity)} \\\\\nx &= \\ln(S/K) \\quad \\text{(log-moneyness)} \\\\\nu(\\tau, x) &= e^{r\\tau} \\frac{V(T-\\tau, Ke^x)}{K}\n\\end{align}\n:::\n\n::: {.callout-important icon=false}\n## Lemma 4.4 (Transformed PDE)\nThe function $u(\\tau, x)$ satisfies the diffusion equation:\n$\\frac{\\partial u}{\\partial \\tau} = \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 u}{\\partial x^2} + \\left(r - \\frac{\\sigma^2}{2}\\right) \\frac{\\partial u}{\\partial x}$\n\nwith initial condition:\n$u(0, x) = (e^x - 1)^+$\n:::\n\n::: {.callout-note collapse=\"true\"}\n## Proof of Lemma 4.4\nWe need to compute the partial derivatives of $V$ in terms of $u$. We have:\n$V(t,S) = K e^{-r(T-t)} u(T-t, \\ln(S/K))$\n\nLet $\\tau = T-t$ and $x = \\ln(S/K)$. Then:\n\n\\begin{align}\n\\frac{\\partial V}{\\partial t} &= K e^{-r\\tau} \\left[r u - \\frac{\\partial u}{\\partial \\tau}\\right] \\\\\n\\frac{\\partial V}{\\partial S} &= K e^{-r\\tau} \\frac{1}{S} \\frac{\\partial u}{\\partial x} \\\\\n\\frac{\\partial^2 V}{\\partial S^2} &= K e^{-r\\tau} \\frac{1}{S^2} \\left[\\frac{\\partial^2 u}{\\partial x^2} - \\frac{\\partial u}{\\partial x}\\right]\n\\end{align}\n\nSubstituting into the Black-Scholes PDE and simplifying (after dividing by $K e^{-r\\tau}$):\n$-\\frac{\\partial u}{\\partial \\tau} + \\left(r - \\frac{\\sigma^2}{2}\\right) \\frac{\\partial u}{\\partial x} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 u}{\\partial x^2} = 0$\n\nTherefore:\n$\\frac{\\partial u}{\\partial \\tau} = \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 u}{\\partial x^2} + \\left(r - \\frac{\\sigma^2}{2}\\right) \\frac{\\partial u}{\\partial x}$\n\nThe initial condition at $\\tau = 0$ (i.e., $t = T$) is:\n$u(0, x) = \\frac{(Ke^x - K)^+}{K} = (e^x - 1)^+$\n:::\n\n::: {.callout-important icon=false}\n## Theorem 4.3 (Solution via Fundamental Solution)\nThe solution to the transformed PDE is:\n$u(\\tau, x) = \\int_{-\\infty}^{\\infty} (e^y - 1)^+ G(\\tau; x, y) dy$\n\nwhere $G(\\tau; x, y)$ is the fundamental solution:\n$G(\\tau; x, y) = \\frac{1}{\\sqrt{2\\pi\\sigma^2\\tau}} \\exp\\left(-\\frac{(y - x - (r-\\sigma^2/2)\\tau)^2}{2\\sigma^2\\tau}\\right)$\n:::\n\n## Step 8: Computing the Solution\n\n::: {.callout-important icon=false}\n## Theorem 4.4 (Explicit Solution of the PDE)\nAfter computing the integral (which follows the same steps as in the martingale approach), we obtain:\n$u(\\tau, x) = e^x \\Phi(d_1) - \\Phi(d_2)$\n\nwhere:\n\\begin{align}\nd_1 &= \\frac{x + (r + \\sigma^2/2)\\tau}{\\sigma\\sqrt{\\tau}} \\\\\nd_2 &= \\frac{x + (r - \\sigma^2/2)\\tau}{\\sigma\\sqrt{\\tau}} = d_1 - \\sigma\\sqrt{\\tau}\n\\end{align}\n:::\n\n::: {.callout-important icon=false}\n## Theorem 4.5 (Black-Scholes Formula via PDE Method)\nTransforming back to the original variables, the European call option price is:\n$V(t,S) = S \\Phi(d_1) - K e^{-r(T-t)} \\Phi(d_2)$\n\nwhere:\n\\begin{align}\nd_1 &= \\frac{\\ln(S/K) + (r + \\sigma^2/2)(T-t)}{\\sigma\\sqrt{T-t}} \\\\\nd_2 &= d_1 - \\sigma\\sqrt{T-t}\n\\end{align}\n:::\n\n::: {.callout-note collapse=\"true\"}\n## Proof of Theorem 4.5\nWe have:\n$V(t,S) = K e^{-r(T-t)} u(T-t, \\ln(S/K))$\n\nThe transformation from the $u$ solution to the $V$ solution follows the same integration techniques as in the martingale approach. The key insight is that both methods yield identical results, demonstrating the equivalence of risk-neutral valuation and PDE approaches.\n:::\n\n# Verification and Conclusion\n\n::: {.callout-important icon=false}\n## Theorem 5.1 (Equivalence of Both Methods)\nBoth the martingale approach and the PDE approach yield the identical Black-Scholes formula:\n$V(t,S) = S \\Phi(d_1) - K e^{-r(T-t)} \\Phi(d_2)$\n\nThis demonstrates the deep connection between:\n\n- Risk-neutral valuation (martingale theory)\n- Dynamic hedging and partial differential equations  \n- Stochastic calculus and deterministic analysis\n:::\n\n## Economic Interpretation\n\n::: {.callout-tip icon=false}\n## Remark 5.1 (Economic Interpretation)\nThe Black-Scholes formula has a clear economic interpretation:\n\n- $S \\Phi(d_1)$: Expected value of the stock if exercised, weighted by probability of exercise\n- $K e^{-r(T-t)} \\Phi(d_2)$: Present value of strike price, weighted by probability of exercise  \n- $\\Phi(d_2)$: Risk-neutral probability that option finishes in-the-money\n- $\\Delta = \\frac{\\partial V}{\\partial S} = \\Phi(d_1)$: Hedge ratio (number of shares to hold per option)\n:::\n\n## Key Insights\n\n::: {.callout-tip icon=false}\n## Remark 5.2 (Key Insights)\nThe derivation reveals several fundamental insights:\n\n1. The option price depends only on the risk-free rate $r$, not the actual expected return $\\mu$ of the stock\n2. Perfect hedging is possible in continuous time with continuous trading\n3. The same formula emerges from completely different mathematical approaches\n4. The risk-neutral measure transforms the pricing problem into an expectation calculation\n:::\n\n## Greeks and Risk Management\n\n::: {.callout-note icon=false}\n## Definition 5.1 (The Greeks)\nThe **Greeks** measure sensitivities of the option price to various parameters:\n\n**Delta**: $\\Delta = \\frac{\\partial V}{\\partial S} = \\Phi(d_1)$\n- Measures sensitivity to stock price changes\n- Represents the hedge ratio\n\n**Gamma**: $\\Gamma = \\frac{\\partial^2 V}{\\partial S^2} = \\frac{\\phi(d_1)}{S\\sigma\\sqrt{T-t}}$\n- Measures rate of change of delta\n- Important for portfolio convexity\n\n**Theta**: $\\Theta = \\frac{\\partial V}{\\partial t} = -\\frac{S\\phi(d_1)\\sigma}{2\\sqrt{T-t}} - rKe^{-r(T-t)}\\Phi(d_2)$\n- Measures time decay\n- Always negative for long call options\n\n**Vega**: $\\nu = \\frac{\\partial V}{\\partial \\sigma} = S\\phi(d_1)\\sqrt{T-t}$\n- Measures sensitivity to volatility changes\n- Always positive for long options\n\n**Rho**: $\\rho = \\frac{\\partial V}{\\partial r} = K(T-t)e^{-r(T-t)}\\Phi(d_2)$\n- Measures sensitivity to interest rate changes\n\nwhere $\\phi(x) = \\frac{1}{\\sqrt{2\\pi}}e^{-x^2/2}$ is the standard normal density.\n:::\n\n## Extensions and Limitations\n\n::: {.callout-warning icon=false}\n## Remark 5.3 (Model Assumptions and Limitations)\nThe Black-Scholes model relies on several strong assumptions:\n\n**Assumptions:**\n- Constant risk-free rate and volatility\n- No dividends\n- European exercise only\n- No transaction costs\n- Continuous trading possible\n- Log-normal stock price distribution\n\n**Limitations:**\n- Volatility smile/skew not captured\n- Jump risk ignored\n- Early exercise features not handled\n- Transaction costs can be significant\n- Liquidity constraints in practice\n\n**Extensions:**\n- American options (early exercise)\n- Stochastic volatility models (Heston, etc.)\n- Jump-diffusion models (Merton)\n- Dividend-paying stocks\n- Time-dependent parameters\n:::\n\n## Computational Implementation\n\n::: {.callout-note icon=false}\n## Example 5.1 (Python Implementation)\n\n```python\nimport numpy as np\nfrom scipy.stats import norm\n\ndef black_scholes_call(S, K, T, r, sigma):\n    \"\"\"\n    Calculate Black-Scholes call option price\n    \n    Parameters:\n    S: Current stock price\n    K: Strike price  \n    T: Time to expiration\n    r: Risk-free rate\n    sigma: Volatility\n    \"\"\"\n    d1 = (np.log(S/K) + (r + 0.5*sigma**2)*T) / (sigma*np.sqrt(T))\n    d2 = d1 - sigma*np.sqrt(T)\n    \n    call_price = S*norm.cdf(d1) - K*np.exp(-r*T)*norm.cdf(d2)\n    \n    return call_price\n\ndef calculate_greeks(S, K, T, r, sigma):\n    \"\"\"Calculate the Greeks\"\"\"\n    d1 = (np.log(S/K) + (r + 0.5*sigma**2)*T) / (sigma*np.sqrt(T))\n    d2 = d1 - sigma*np.sqrt(T)\n    \n    delta = norm.cdf(d1)\n    gamma = norm.pdf(d1) / (S*sigma*np.sqrt(T))\n    theta = (-S*norm.pdf(d1)*sigma/(2*np.sqrt(T)) \n             - r*K*np.exp(-r*T)*norm.cdf(d2))\n    vega = S*norm.pdf(d1)*np.sqrt(T)\n    rho = K*T*np.exp(-r*T)*norm.cdf(d2)\n    \n    return {'delta': delta, 'gamma': gamma, 'theta': theta, 'vega': vega, 'rho': rho}\n\n# Example usage\nS0 = 100    # Current stock price\nK = 105     # Strike price\nT = 0.25    # 3 months to expiration\nr = 0.05    # 5% risk-free rate  \nsigma = 0.2 # 20% volatility\n\nprice = black_scholes_call(S0, K, T, r, sigma)\ngreeks = calculate_greeks(S0, K, T, r, sigma)\n\nprint(f\"Call option price: ${price:.2f}\")\nprint(f\"Delta: {greeks['delta']:.4f}\")\nprint(f\"Gamma: {greeks['gamma']:.4f}\")\n```\n:::\n\nThis complete treatment of the Black-Scholes model provides both theoretical rigor and practical applicability, showing how mathematical finance bridges pure mathematics and real-world financial applications."},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"toc-depth":4,"html-math-method":"katex","output-file":"StochC.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","jupyter":"python3","theme":{"light":"flatly","dark":"darkly"},"toc-location":"right","title":"Stochastic Calculus","abstract":"Would be including the notes and topics from Shreve's and Grezelak's book as well topics that would fall into this category.Including code implementation in python based of the book.<br/><br/>DISCLAIMER THERE IS AT TIMES LOT OF HAND WAVING ,THIS IS NOT AS MATHEMATICALLY RIGOROUS AS YOU WOULD EXPECT LIKE IN A PURE MATH TEXTBOOK.","style":"background : #020508"},"extensions":{"book":{"multiFile":true}}}}}