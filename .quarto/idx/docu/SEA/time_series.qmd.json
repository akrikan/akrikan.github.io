{"title":"Time Series Analysis","markdown":{"yaml":{"title":"Time Series Analysis","execute":{"warning":false,"freeze":true,"cache":true},"format":{"html":{"html-math-method":"katex","code-block-bg":"#E5E7E9","df-print":"paged","code-overflow":"wrap","code-copy":true}}},"headingText":"Introduction","containsRefs":false,"markdown":"\n\n\n### Resources\n\n-   Time series analysis by James D Hamilton - its considered to be the bible on time series analysis, pretty much covers all the theory , it doesnt have any code or pseudocode\n\n-   Introduction to Time Series with R by Metcalfe & Coweperwait\n\n-   Analysis of Financial Time Series by Tsay\n\n### Aim and Motivation\n\n-   Would be exploring time series analysis in the context of finance\n-   Implementing code from the book by Tsay , would be using the book by Hamilton and Metcalfe as reference\n-   Aim to understand different time series models in R.\n-   (Will keep on expanding this section on the go)\n\n## Financial Time Series and Linear Time series\n\n### Asset Returns\n\n::: {#def-Simple_gross_return}\n## Simple gross return\n\n<br/> <u>Arithmetic Returns</u>\n\n$$P_t = P_{t-1}(1+R_t) \\implies R_t = \\frac{P_t - P_{t-1}}{P_t}$$ where $P_t$ and $R_t$ are the price and return at time $t$ respectively <br/> <u>Continuously compounded return or log return</u>\n\n$$r_t = \\ln(1+R_t)$$ <br/> <u>Dividend Payment</u>\n\n$$r_t = \\ln(P_t + D_t) -\\ln(P_{t-1})$$ Where $D_t$ is dividend payment between time t-1 and time t .\n:::\n\n<br/>\n\n::: {#def-Multiperiod_simple_return}\n## Multiperiod gross return\n\n<br/> Similiary we can define <u>multiperiod simple return</u> by $$ R_t[k] = exp{[\\frac{1}{k}\\sum_{j=0}^{k-1}(1+R_{t-j})]} -1$$ where exp is the exponentential function and k is total number periods the asset was held for.\n\n<u>Log return</u> would be $$ r_t[k] = r_t +r_{t-1}+.....+r_{t-k+1}$$\n:::\n\n::: {#def-Portfolio_return}\n## Portfolio Return\n\n$$R_{p,t}= \\sum_{i=1}^{N}w_i R_{it}$$\n\nWhere $p$ is the portfolio , $i$ the ith asset and $w_i$ the weight of the $i^{th}$ asset in the portfolio\n:::\n\n[\\* Load data and header =T give the 1st row of the data file , that is the names of the cloumns of the data set]{.aside}\n\n```{r}\n#| code-block-border-right: false\n# da contains the return for 5 five stocks and indexes namely IBM ,value-weighted , equal-weighted and S&P composite index from 1970 to 2008\nlibrary(fBasics)\nda = read.table(\"TST/d-ibm3dx7008.txt\",header = T) \ndim(da) # dimensions for the data\nda[1:5,]# first five rows\ntail(da)#Last 5 rows\nibm = da[,2] # IBM simple returns\n\nsibm = ibm*100 #Percentage simple returns \n\nb = basicStats(sibm)\n\ns1 = skewness(sibm)\nt = s1/sqrt(6/9845) #definition for test statistic here 9845 is N \npv  = 2*(1-pnorm(t)) # Calculate p-value\n\ncat(\"skewness =\", s1,\"\\nTest Satistic = \",t,\"\\np-value = \", pv)\n\n```\n\n```{r}\n#| layout-ncol: 2\nlibrary(ggplot2)\nibm = as.data.frame(da[,1:2])\n\nibm[\"log_return\"] = log(1+ibm[\"rtn\"])\ncolnames(ibm)[2] <- \"simple_return\"\n\nggplot(ibm,aes(x = simple_return,colour=\"Emperical\"))+\n      ggtitle(\"Simple return distribution\") + \n      xlim (-0.15,0.15)+\n      geom_density()+\n      stat_function(mapping = aes(colour =\"Normal\"),\n                   fun = dnorm,args = with(ibm,c(mean =mean(simple_return),\n                   sd = sd(simple_return))))\n\n\nggplot(ibm,aes(x = log_return,colour = \"Emperical\"))+\n      ggtitle(\"Log return distribution\")+ \n      xlim (-0.15,0.15)+geom_density()+\n      stat_function(mapping = aes(colour = \"Normal\"),\n             fun = dnorm,args = with(ibm,c(mean = mean(log_return),\n             sd = sd(log_return))))+ \nscale_x_continuous(\"log return distribution\",limits = c(-0.15,0.15))\n\n```\n\n```{r}\n#IBM = ibm[, 2] # IBM simple return values\n#IBM = ts(IBM,frequency = 250 ,start = c(1970,1))\n\n#plot.ts(IBM)\n\n\n#acf(IBM,lag=250,ylim= c(-0.05,0.05))#ACF is covered in detail down below , the x axis label is fraction of unit time \n\n#libm = ibm[,2]*100\n#length(libm)\n#mean(libm)\n#t.test(libm)\n#k1 = kurtosis(libm)\n#s1 =skewness(libm)\n#t3  = (s1^2)/(6/9845)\n#t2 = ((k1)^2)/(24/9845)\n#3t2\n#a = t2+t3\n#a\n#normalTest(libm,method = 'jb')\n```\n\n### Linear Time Series\n\n<u> Stationarity</u>\n\nFoundation of time series analysis is Stationarity. A time series $\\{r_t\\}$ is said to be strictly stationary if the joint distribution of $(r_{t_{1}},r_{t_{2}},r_{t_{3}},....,r_{t_{k}})$ is identical to that of $(r_{t_{1+t}},r_{t_{2+t}},r_{t_{3+t}},....,r_{t_{k+t}})$ for all $t$ , where $k$ is an arbitrary positive integer and $(t_1,t_2,t_3,....,t_k)$ is collection of $k$ positive integers. Strict stationarity is very hard to verify emperically <br/> A time series is said to be weakly stationary if the mean of $r_t$ and the covariance between $r_t$ and $r_{t-l}$ are time invariant where $l$ is an arbitrary integer. Weak stationarity enables us to make inference concerning future observations\n\n-   $\\mathbb{E}(t_t) = \\mu$\n-   $Cov(r_t,r_{t-l}) = \\gamma_l$\n\nWeak stationarity is commonly studied and more practical.\n\nThe covariance $\\gamma_l = Cov(r_t,r_{t-l})$ is called the <u>lag-$l$ autocovariance of $r_t$</u>. From the above defintion it follows that\n\n-   $\\gamma_0=Var(r_t)$\n-   $\\gamma_{-l} = \\gamma_l$\n\n<u> Autocorrelation Function</u>\n\nConsider a weakly stationary return series $r_t$. When the linear dependence between $r_t$ and its past values $r_{t-l}$ is of interest , the concept of correlation is generalised to autocorrelation. The correlation coefficient between $r_t$ and $r_{t-l}$ is called the lag-l autocorrelation of $r_t$ and is commonly denoted by $\\rho_l$ , which under the weak stationarity assumption is a function of l only. Its defined by $$ \\rho_l = \\frac{Cov(r_t,r_{t-l})}{\\sqrt{Var(r_t)Var(r_{t-l})}} = \\frac{Cov(r_t,r_{t-l})}{Var(r_t)} = \\frac{\\gamma_l}{\\gamma_0}$$\n\nIts easy to see that\n\n-   $\\rho_0 = 1$\n-   $\\rho_l = \\rho_{-l}$\n-   $-1\\leq \\rho_l \\leq 1$\n\nFor a given sample of returns $\\{r_t\\}_{t=1}^T$ , let $\\bar r$ be the sample mean. Then the lag-1 autocorrelation of $r_t$ is $$\\hat\\rho_1 = \\frac{\\sum_{t=2}^T(r_t - \\bar r)(r_{t-1} - \\bar r)}{\\sum_{t=2}^T(r_t - \\bar r )^2}$$\n\nThe conditions under which $\\hat\\rho$ is a consistent estimator of $\\rho_1$ are as follows :\n\n-   The returns $\\{r_t\\}$ is an independent and identically distributed sequence\n-   $\\mathbb{E}(r_t^2) < \\infty$\n\nThen $\\hat\\rho_1$ is asymptotically normal with mean zero and variance 1/T\n\n<u>Testing</u>\n\nLet $H_0 : \\rho_1 = 0$ be the null hypothesis versus $H_a : \\rho_1 \\neq 0$ the alternative hypothesis. The test statistic is the usual t ratio (check the statistics section for further description) , which is $\\sqrt{T}\\hat\\rho_1$ and follows asymptotically the standard normal distribution. The null hypothesis $H_0$ is rejected if the t ratio is large in magnitude or equivalently , the p value of the t ratio is small , lets say less than 0.05\n\n```{r}\n\nset.seed(666)\nphi = c(rep(0,11),.9)\nsAR = arima.sim(list(order=c(12,0,0), ar=phi), n=37)\nsAR = ts(sAR, freq=12)\nlayout(matrix(c(1,1,2, 1,1,3), nc=2))\npar(mar=c(3,3,2,1), mgp=c(1.6,.6,0))\nplot(sAR, axes=FALSE, main='seasonal AR(1)', xlab=\"year\", type='c')\nMonths = c(\"J\",\"F\",\"M\",\"A\",\"M\",\"J\",\"J\",\"A\",\"S\",\"O\",\"N\",\"D\") \npoints(sAR, pch=Months, cex=1.25, font=4, col=1:4)\naxis(1, 1:4); abline(v=1:4, lty=2, col=gray(.7))\naxis(2); box()\nACF = ARMAacf(ar=phi, ma=0, 100)\nPACF = ARMAacf(ar=phi, ma=0, 100, pacf=TRUE)\nplot(ACF,type=\"h\", xlab=\"LAG\", ylim=c(-.1,1)); abline(h=0) \nplot(PACF, type=\"h\", xlab=\"LAG\", ylim=c(-.1,1)); abline(h=0)\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"paged","error":false,"eval":true,"cache":true,"freeze":true,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"toc-depth":4,"html-math-method":"katex","output-file":"time_series.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","jupyter":"python3","theme":"sketchy","toc-location":"right","title":"Time Series Analysis","code-block-bg":"#E5E7E9","code-copy":true},"extensions":{"book":{"multiFile":true}}}}}